%
\begin{isabellebody}%
\setisabellecontext{Forkable{\isacharunderscore}Strings}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Forkable{\isacharunderscore}Strings\ \isakeyword{imports}\ Main\ {\isachardoublequoteopen}{\isachartilde}{\isachartilde}{\isacharslash}src{\isacharslash}HOL{\isacharslash}List{\isachardoublequoteclose}\ \isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
We will use True as 1 and False as 0 in characteristic strings; we might think about each bool
value answers to the question 'is this slot controlled by an adversarial player?'.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{datatype}\isamarkupfalse%
\ nattree\ {\isacharequal}\ Empty\ {\isacharbar}\ Node\ nat\ {\isachardoublequoteopen}nattree\ list{\isachardoublequoteclose}%
\begin{isamarkuptext}%
One reason why we don't have Leaves here is that we have to define prefixes of tines carefully 
so that we don't consider having a leaf with cannot be continue by a list of trees but instead we
can have a list of Emptys in order to extend each Empty by a tree%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{inductive}\isamarkupfalse%
\ ListOfEmpty\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ list\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ Nil\ {\isacharcolon}\ {\isachardoublequoteopen}ListOfEmpty\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
{\isacharbar}\ Cons\ {\isacharcolon}\ {\isachardoublequoteopen}ListOfEmpty\ l\ {\isasymLongrightarrow}\ ListOfEmpty\ {\isacharparenleft}Empty{\isacharhash}l{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\isacommand{inductive}\isamarkupfalse%
\ Leaf\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}ListOfEmpty\ l\ {\isasymLongrightarrow}\ Leaf\ {\isacharparenleft}Node\ n\ l{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \isanewline
\isacommand{fun}\isamarkupfalse%
\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ nattree\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ Empty\ {\isacharequal}\ True{\isachardoublequoteclose}\ \isanewline
{\isacharbar}\ {\isachardoublequoteopen}lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ {\isacharparenleft}Node\ m\ {\isacharunderscore}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}n\ {\isacharless}\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ lt{\isacharunderscore}nat{\isacharunderscore}tree{\isacharunderscore}lt\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}n\ {\isacharless}\ m{\isacharparenright}\ {\isasymlongleftrightarrow}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ {\isacharparenleft}Node\ m\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ lt{\isacharunderscore}nat{\isacharunderscore}tree{\isacharunderscore}ge\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}n\ {\isasymge}\ m{\isacharparenright}\ {\isasymlongleftrightarrow}\ {\isasymnot}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ {\isacharparenleft}Node\ m\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{fun}\isamarkupfalse%
\ increasing{\isacharunderscore}tree\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}increasing{\isacharunderscore}tree\ Empty\ {\isacharequal}\ True{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ {\isacharunderscore}\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ True{\isachardoublequoteclose}\ \isanewline
{\isacharbar}\ {\isachardoublequoteopen}increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isasymforall}x\ {\isasymin}\ set\ l{\isachardot}\ increasing{\isacharunderscore}tree\ x\ {\isasymand}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ x{\isacharparenright}{\isachardoublequoteclose}\ \ \isanewline
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ increasing{\isacharunderscore}tree{\isacharunderscore}branch{\isacharunderscore}list{\isacharunderscore}of{\isacharunderscore}empty\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}ListOfEmpty\ x\ {\isasymlongrightarrow}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ x{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ x{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ a{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ Empty\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ nn\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ list\ {\isasymRightarrow}\ nattree\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ nattree{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymforall}x{\isadigit{0}}\ x{\isadigit{1}}\ x{\isadigit{2}}{\isachardot}\ {\isacharparenleft}{\isasymexists}v{\isadigit{3}}{\isachardot}\ v{\isadigit{3}}\ {\isasymin}\ set\ {\isacharparenleft}x{\isadigit{1}}\ {\isacharhash}\ x{\isadigit{0}}{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}{\isasymnot}\ increasing{\isacharunderscore}tree\ v{\isadigit{3}}\ {\isasymor}\ {\isasymnot}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ x{\isadigit{2}}\ v{\isadigit{3}}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}nn\ x{\isadigit{0}}\ x{\isadigit{1}}\ x{\isadigit{2}}\ {\isasymin}\ set\ {\isacharparenleft}x{\isadigit{1}}\ {\isacharhash}\ x{\isadigit{0}}{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}{\isasymnot}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}nn\ x{\isadigit{0}}\ x{\isadigit{1}}\ x{\isadigit{2}}{\isacharparenright}\ {\isasymor}\ {\isasymnot}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ x{\isadigit{2}}\ {\isacharparenleft}nn\ x{\isadigit{0}}\ x{\isadigit{1}}\ x{\isadigit{2}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ moura\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}n\ na\ ns{\isachardot}\ {\isacharparenleft}{\isasymnot}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ {\isacharparenleft}na\ {\isacharhash}\ ns{\isacharparenright}{\isacharparenright}\ {\isasymor}\ {\isacharparenleft}{\isasymforall}nb{\isachardot}\ nb\ {\isasymnotin}\ set\ {\isacharparenleft}na\ {\isacharhash}\ ns{\isacharparenright}\ {\isasymor}\ increasing{\isacharunderscore}tree\ nb\ {\isasymand}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ nb{\isacharparenright}{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ {\isacharparenleft}na\ {\isacharhash}\ ns{\isacharparenright}{\isacharparenright}\ {\isasymor}\ nn\ ns\ na\ n\ {\isasymin}\ set\ {\isacharparenleft}na\ {\isacharhash}\ ns{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}{\isasymnot}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}nn\ ns\ na\ n{\isacharparenright}\ {\isasymor}\ {\isasymnot}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ {\isacharparenleft}nn\ ns\ na\ n{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ increasing{\isacharunderscore}tree{\isachardot}simps{\isacharparenleft}{\isadigit{3}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ nns\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ list\ {\isasymRightarrow}\ nattree\ list{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ f{\isadigit{2}}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}ns{\isachardot}\ {\isacharparenleft}{\isasymnot}\ ListOfEmpty\ ns\ {\isasymor}\ ns\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymor}\ ns\ {\isacharequal}\ Empty\ {\isacharhash}\ nns\ ns\ {\isasymand}\ ListOfEmpty\ {\isacharparenleft}nns\ ns{\isacharparenright}{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}ListOfEmpty\ ns\ {\isasymor}\ ns\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymand}\ {\isacharparenleft}{\isasymforall}nsa{\isachardot}\ ns\ {\isasymnoteq}\ Empty\ {\isacharhash}\ nsa\ {\isasymor}\ {\isasymnot}\ ListOfEmpty\ nsa{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ ListOfEmpty{\isachardot}simps{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}Empty\ {\isacharhash}\ x\ {\isacharequal}\ Empty\ {\isacharhash}\ nns\ {\isacharparenleft}a\ {\isacharhash}\ x{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}x\ {\isacharequal}\ nns\ {\isacharparenleft}a\ {\isacharhash}\ x{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{2}}\ f{\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharparenright}\ Cons{\isachardot}IH\ Empty\ in{\isacharunderscore}set{\isacharunderscore}member\ increasing{\isacharunderscore}tree{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ lt{\isacharunderscore}nat{\isacharunderscore}tree{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ member{\isacharunderscore}rec{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ member{\isacharunderscore}rec{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\ \isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Node\ x{\isadigit{2}}{\isadigit{1}}\ x{\isadigit{2}}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ListOfEmpty{\isachardot}simps\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ increasing{\isacharunderscore}tree{\isacharunderscore}ind\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymforall}x\ {\isasymin}\ set\ l{\isachardot}\ increasing{\isacharunderscore}tree\ x\ {\isasymand}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ x{\isacharparenright}\ {\isasymlongleftrightarrow}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\ \isacommand{fix}\isamarkupfalse%
\ nn\ {\isacharcolon}{\isacharcolon}\ nattree\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ nna\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{and}\ nnb\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nattree{\isachardoublequoteclose}\ \isakeyword{and}\ nns\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nattree\ list{\isachardoublequoteclose}\ \isakeyword{and}\ nnc\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nattree{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ \ \ \ \ ff{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}n{\isachardot}\ increasing{\isacharunderscore}tree\ n\ {\isasymor}\ Node\ {\isacharparenleft}nna\ n{\isacharparenright}\ {\isacharparenleft}nnb\ n\ {\isacharhash}\ nns\ n{\isacharparenright}\ {\isacharequal}\ n\ {\isasymand}\ nnc\ n\ {\isasymin}\ set\ {\isacharparenleft}nnb\ n\ {\isacharhash}\ nns\ n{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}{\isasymnot}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}nnc\ n{\isacharparenright}\ {\isasymor}\ {\isasymnot}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ {\isacharparenleft}nna\ n{\isacharparenright}\ {\isacharparenleft}nnc\ n{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ increasing{\isacharunderscore}tree{\isachardot}elims{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ moura\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}n\ ns{\isachardot}\ {\isacharparenleft}n{\isacharcolon}{\isacharcolon}nattree{\isacharparenright}\ {\isasymnotin}\ set\ ns\ {\isasymor}\ {\isacharparenleft}{\isasymexists}nsa{\isachardot}\ n\ {\isacharhash}\ nsa\ {\isacharequal}\ ns{\isacharparenright}\ {\isasymor}\ {\isacharparenleft}{\isasymexists}na\ nsa{\isachardot}\ na\ {\isacharhash}\ nsa\ {\isacharequal}\ ns\ {\isasymand}\ n\ {\isasymin}\ set\ nsa{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ list{\isachardot}set{\isacharunderscore}cases{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ nnsa\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nattree\ list\ {\isasymRightarrow}\ nattree\ list{\isachardoublequoteclose}\ \isakeyword{and}\ nnd\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nattree\ list\ {\isasymRightarrow}\ nattree{\isachardoublequoteclose}\ \isakeyword{and}\ nnsb\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nattree\ list\ {\isasymRightarrow}\ nattree\ list{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ \ \ \ \ ff{\isadigit{2}}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}n\ ns{\isachardot}\ n\ {\isasymnotin}\ set\ ns\ {\isasymor}\ n\ {\isacharhash}\ nnsa\ n\ ns\ {\isacharequal}\ ns\ {\isasymor}\ nnd\ n\ ns\ {\isacharhash}\ nnsb\ n\ ns\ {\isacharequal}\ ns\ {\isasymand}\ n\ {\isasymin}\ set\ {\isacharparenleft}nnsb\ n\ ns{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ moura\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ nne\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ nattree\ {\isasymRightarrow}\ nattree\ list\ {\isasymRightarrow}\ nattree{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ \ \ \ \ ff{\isadigit{3}}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}n\ na\ ns{\isachardot}\ {\isacharparenleft}{\isasymnot}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ {\isacharparenleft}na\ {\isacharhash}\ ns{\isacharparenright}{\isacharparenright}\ {\isasymor}\ {\isacharparenleft}{\isasymforall}nb{\isachardot}\ nb\ {\isasymnotin}\ set\ {\isacharparenleft}na\ {\isacharhash}\ ns{\isacharparenright}\ {\isasymor}\ increasing{\isacharunderscore}tree\ nb\ {\isasymand}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ nb{\isacharparenright}{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}nne\ n\ na\ ns\ {\isasymin}\ set\ {\isacharparenleft}na\ {\isacharhash}\ ns{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}{\isasymnot}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}nne\ n\ na\ ns{\isacharparenright}\ {\isasymor}\ {\isasymnot}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ {\isacharparenleft}nne\ n\ na\ ns{\isacharparenright}{\isacharparenright}\ {\isasymor}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ {\isacharparenleft}na\ {\isacharhash}\ ns{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ moura\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ ff{\isadigit{4}}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}n\ na\ nb\ ns{\isachardot}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ nb\ n\ {\isasymor}\ n\ {\isasymnotin}\ set\ {\isacharparenleft}nnd\ na\ ns\ {\isacharhash}\ nnsb\ na\ ns{\isacharparenright}\ {\isasymor}\ {\isasymnot}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ nb\ ns{\isacharparenright}\ {\isasymor}\ na\ {\isacharhash}\ nnsa\ na\ ns\ {\isacharequal}\ ns\ {\isasymor}\ na\ {\isasymnotin}\ set\ ns{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ff{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}nn\ {\isacharhash}\ nnsa\ nn\ l\ {\isasymnoteq}\ l{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}na{\isachardot}\ nn\ {\isacharhash}\ nnsa\ nn\ l\ {\isasymnoteq}\ l\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ na\ {\isacharparenleft}nnd\ nn\ l\ {\isacharhash}\ nnsb\ nn\ l{\isacharparenright}{\isacharparenright}\ {\isasymand}\ nn\ {\isacharhash}\ nnsa\ nn\ l\ {\isasymnoteq}\ l\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}na\ nb{\isachardot}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymand}\ nn\ {\isacharhash}\ nnsa\ nn\ l\ {\isasymnoteq}\ l\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ na\ {\isacharparenleft}nnd\ nb\ l\ {\isacharhash}\ nnsb\ nb\ l{\isacharparenright}{\isacharparenright}\ {\isasymand}\ nb\ {\isacharhash}\ nnsa\ nb\ l\ {\isasymnoteq}\ l\ {\isasymand}\ nb\ {\isasymin}\ set\ l\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}na\ nb\ nc{\isachardot}\ nb\ {\isasymin}\ set\ l\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymand}\ nb\ {\isacharhash}\ nnsa\ nb\ l\ {\isasymnoteq}\ l\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ nc\ {\isacharparenleft}nnd\ na\ l\ {\isacharhash}\ nnsb\ na\ l{\isacharparenright}{\isacharparenright}\ {\isasymand}\ na\ {\isacharhash}\ nnsa\ na\ l\ {\isasymnoteq}\ l\ {\isasymand}\ na\ {\isasymin}\ set\ l\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}na\ nb\ nc\ ns{\isachardot}\ nb\ {\isacharhash}\ nnsa\ nb\ ns\ {\isasymnoteq}\ ns\ {\isasymand}\ nb\ {\isasymin}\ set\ ns\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymand}\ nn\ {\isasymin}\ set\ ns\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ ns{\isacharparenright}\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ na\ {\isacharparenleft}nnd\ nc\ l\ {\isacharhash}\ nnsb\ nc\ l{\isacharparenright}{\isacharparenright}\ {\isasymand}\ nc\ {\isacharhash}\ nnsa\ nc\ l\ {\isasymnoteq}\ l\ {\isasymand}\ nc\ {\isasymin}\ set\ l\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}nn\ {\isasymnotin}\ set\ l\ {\isasymor}\ increasing{\isacharunderscore}tree\ nn\ {\isasymand}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ nn{\isacharparenright}\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymor}\ {\isasymnot}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}{\isasymexists}na{\isachardot}\ na\ {\isasymin}\ set\ l\ {\isasymand}\ {\isacharparenleft}{\isasymnot}\ increasing{\isacharunderscore}tree\ na\ {\isasymor}\ {\isasymnot}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ na{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ff{\isadigit{4}}\ ff{\isadigit{3}}\ ff{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharparenright}{\isacharparenright}\ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}nn\ {\isasymnotin}\ set\ l\ {\isasymor}\ increasing{\isacharunderscore}tree\ nn\ {\isasymand}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ nn{\isacharparenright}\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymor}\ {\isasymnot}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}{\isasymexists}na{\isachardot}\ na\ {\isasymin}\ set\ l\ {\isasymand}\ {\isacharparenleft}{\isasymnot}\ increasing{\isacharunderscore}tree\ na\ {\isasymor}\ {\isasymnot}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ na{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}nn\ {\isasymnotin}\ set\ l\ {\isasymor}\ increasing{\isacharunderscore}tree\ nn\ {\isasymand}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ nn{\isacharparenright}\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymor}\ {\isasymnot}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}{\isasymexists}na{\isachardot}\ na\ {\isasymin}\ set\ l\ {\isasymand}\ {\isacharparenleft}{\isasymnot}\ increasing{\isacharunderscore}tree\ na\ {\isasymor}\ {\isasymnot}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ na{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}nn\ {\isasymnotin}\ set\ l\ {\isasymor}\ increasing{\isacharunderscore}tree\ nn\ {\isasymand}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ nn{\isacharparenright}\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymor}\ {\isasymnot}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}{\isasymexists}na{\isachardot}\ na\ {\isasymin}\ set\ l\ {\isasymand}\ {\isacharparenleft}{\isasymnot}\ increasing{\isacharunderscore}tree\ na\ {\isasymor}\ {\isasymnot}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ na{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}nn\ {\isasymnotin}\ set\ l\ {\isasymor}\ increasing{\isacharunderscore}tree\ nn\ {\isasymand}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ nn{\isacharparenright}\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymor}\ {\isasymnot}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}{\isasymexists}na{\isachardot}\ na\ {\isasymin}\ set\ l\ {\isasymand}\ {\isacharparenleft}{\isasymnot}\ increasing{\isacharunderscore}tree\ na\ {\isasymor}\ {\isasymnot}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ na{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ff{\isadigit{3}}\ ff{\isadigit{2}}\ ff{\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharparenright}\ nattree{\isachardot}inject{\isacharparenright}\ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}nn\ {\isasymnotin}\ set\ l\ {\isasymor}\ increasing{\isacharunderscore}tree\ nn\ {\isasymand}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ nn{\isacharparenright}\ {\isasymand}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymor}\ {\isasymnot}\ increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}{\isasymexists}na{\isachardot}\ na\ {\isasymin}\ set\ l\ {\isasymand}\ {\isacharparenleft}{\isasymnot}\ increasing{\isacharunderscore}tree\ na\ {\isasymor}\ {\isasymnot}\ lt{\isacharunderscore}nat{\isacharunderscore}tree\ n\ na{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ff{\isadigit{3}}\ ff{\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharparenright}\ list{\isachardot}set{\isacharunderscore}intros{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ nattree{\isachardot}inject{\isacharparenright}\ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ ListMax\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ list\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}ListMax\ l\ {\isacharequal}\ foldr\ max\ l\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ ListMax{\isacharunderscore}{\isadigit{0}}\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}ListMax\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ ListMax{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Listmax{\isacharunderscore}ge\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}x\ {\isasymin}\ set\ l{\isachardot}\ x\ {\isasymle}\ ListMax\ l{\isachardoublequoteclose}\ \ \ \ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ l{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ l{\isacharparenright}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}ListMax\ {\isacharparenleft}Cons\ a\ l{\isacharparenright}\ {\isacharequal}\ max\ a\ {\isacharparenleft}ListMax\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ListMax{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}ListMax\ l\ {\isasymle}\ ListMax\ {\isacharparenleft}Cons\ a\ l{\isacharparenright}\ {\isasymand}\ a\ {\isasymle}\ ListMax\ {\isacharparenleft}Cons\ a\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ {\isacartoucheopen}ListMax\ {\isacharparenleft}a\ {\isacharhash}\ l{\isacharparenright}\ {\isacharequal}\ max\ a\ {\isacharparenleft}ListMax\ l{\isacharparenright}{\isacartoucheclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isachardot}IH\ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{fun}\isamarkupfalse%
\ height\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}height\ Empty\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \ \isanewline
{\isacharbar}\ {\isachardoublequoteopen}height\ {\isacharparenleft}Node\ n\ bl{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}if\ Leaf\ {\isacharparenleft}Node\ n\ bl{\isacharparenright}\ then\ {\isadigit{0}}\ else\ Suc\ {\isacharparenleft}ListMax\ {\isacharparenleft}map\ height\ bl{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ height{\isacharunderscore}Leaf\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}Leaf\ n\ {\isasymlongrightarrow}\ height\ n\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ height{\isachardot}elims{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Leaf{\isacharunderscore}ind\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}Leaf\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\ Leaf\ {\isacharparenleft}Node\ n\ {\isacharparenleft}Empty{\isacharhash}l{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Leaf{\isachardot}simps\ ListOfEmpty{\isachardot}simps\ list{\isachardot}distinct{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ list{\isachardot}sel{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ nattree{\isachardot}inject{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ not{\isacharunderscore}ListOfEmpty{\isacharunderscore}imp{\isacharunderscore}not{\isacharunderscore}Empty{\isacharunderscore}existence\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ ListOfEmpty\ l\ {\isasymlongrightarrow}\ {\isacharparenleft}{\isasymexists}x\ {\isasymin}\ set\ l{\isachardot}\ x\ {\isasymnoteq}\ Empty{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ l{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ ListOfEmpty{\isachardot}Nil{\isacharparenright}\ \isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ l{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\isasymforall}x\ {\isasymin}\ set\ l{\isachardot}\ x\ {\isacharequal}\ Empty{\isacharparenright}\ {\isasymlongrightarrow}\ ListOfEmpty\ l{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharequal}\ Empty\ {\isasymand}\ {\isacharparenleft}{\isasymforall}x\ {\isasymin}\ set\ l{\isachardot}\ x\ {\isacharequal}\ Empty{\isacharparenright}\ {\isasymlongrightarrow}\ ListOfEmpty\ {\isacharparenleft}a{\isacharhash}l{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ ListOfEmpty{\isachardot}Cons\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ ListOfEmpty\ {\isacharparenleft}a{\isacharhash}l{\isacharparenright}\ {\isasymlongrightarrow}\ {\isacharparenleft}a\ {\isasymnoteq}\ Empty\ {\isasymor}\ {\isacharparenleft}{\isasymexists}x\ {\isasymin}\ set\ l{\isachardot}\ x\ {\isasymnoteq}\ Empty{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ not{\isacharunderscore}Leaf{\isacharunderscore}imp{\isacharunderscore}not{\isacharunderscore}List{\isacharunderscore}of{\isacharunderscore}empty\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ \isanewline
{\isachardoublequoteopen}{\isasymnot}\ Leaf\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymlongrightarrow}\ {\isacharparenleft}{\isasymexists}x\ {\isasymin}\ set\ l{\isachardot}\ x\ {\isasymnoteq}\ Empty{\isacharparenright}{\isachardoublequoteclose}\ \ \ \ \isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ Leaf\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymlongrightarrow}\ {\isasymnot}\ ListOfEmpty\ l{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Leaf{\isachardot}intros\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ not{\isacharunderscore}ListOfEmpty{\isacharunderscore}imp{\isacharunderscore}not{\isacharunderscore}Empty{\isacharunderscore}existence\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ Leaf{\isacharunderscore}non{\isacharunderscore}ListOfEmpty\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ \isanewline
{\isachardoublequoteopen}{\isacharparenleft}{\isasymexists}x\ {\isasymin}\ set\ l{\isachardot}\ x\ {\isasymnoteq}\ Empty{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isasymnot}\ Leaf\ {\isacharparenleft}Node\ n\ l{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymexists}x\ {\isasymin}\ set\ l{\isachardot}\ x\ {\isasymnoteq}\ Empty{\isacharparenright}\ {\isasymlongrightarrow}\ {\isacharparenleft}{\isasymnot}\ Leaf\ {\isacharparenleft}Node\ n\ l{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Leaf{\isachardot}cases\ increasing{\isacharunderscore}tree{\isacharunderscore}branch{\isacharunderscore}list{\isacharunderscore}of{\isacharunderscore}empty\ increasing{\isacharunderscore}tree{\isacharunderscore}ind\ \isanewline
lt{\isacharunderscore}nat{\isacharunderscore}tree{\isachardot}elims{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ nat{\isacharunderscore}less{\isacharunderscore}le\ nattree{\isachardot}inject{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ not{\isacharunderscore}Leaf{\isacharunderscore}imp{\isacharunderscore}not{\isacharunderscore}List{\isacharunderscore}of{\isacharunderscore}empty\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ height{\isacharunderscore}ge\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}x\ {\isasymin}\ set\ l{\isachardot}\ height\ x\ \ {\isasymle}\ height\ {\isacharparenleft}Node\ n\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ l{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ empty{\isacharunderscore}iff\ empty{\isacharunderscore}set{\isacharparenright}\ \isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ l{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}height\ {\isacharparenleft}Node\ n\ {\isacharparenleft}Cons\ a\ l{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}if\ Leaf\ {\isacharparenleft}Node\ n\ {\isacharparenleft}Cons\ a\ l{\isacharparenright}{\isacharparenright}\ then\ {\isadigit{0}}\ else\ Suc\ {\isacharparenleft}ListMax\ \isanewline
{\isacharparenleft}map\ height\ {\isacharparenleft}Cons\ a\ l{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ height{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}a{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ Empty\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ lifting{\isacharparenright}\ Leaf{\isacharunderscore}non{\isacharunderscore}ListOfEmpty\ Listmax{\isacharunderscore}ge\ a{\isadigit{1}}\ height{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ image{\isacharunderscore}eqI\ \isanewline
le{\isacharunderscore}SucI\ list{\isachardot}set{\isacharunderscore}map\ order{\isacharunderscore}refl{\isacharparenright}\ \isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Node\ x{\isadigit{2}}{\isadigit{1}}\ x{\isadigit{2}}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ lifting{\isacharparenright}\ Leaf{\isacharunderscore}non{\isacharunderscore}ListOfEmpty\ Listmax{\isacharunderscore}ge\ a{\isadigit{1}}\ height{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ image{\isacharunderscore}eqI\ \isanewline
le{\isacharunderscore}SucI\ le{\isacharunderscore}numeral{\isacharunderscore}extra{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ list{\isachardot}set{\isacharunderscore}map{\isacharparenright}\ \isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ listmax{\isacharunderscore}{\isadigit{0}}\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymforall}\ x\ {\isasymin}\ set\ l{\isachardot}\ f\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharparenright}\ {\isasymlongrightarrow}\ ListMax\ {\isacharparenleft}map\ f\ l{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ l{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ l{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}ListMax\ {\isacharparenleft}map\ f\ {\isacharparenleft}Cons\ a\ l{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ max\ {\isacharparenleft}f\ a{\isacharparenright}\ {\isacharparenleft}ListMax\ {\isacharparenleft}map\ f\ l{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ ListMax{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}f\ a\ {\isacharequal}\ {\isadigit{0}}{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}{\isasymforall}\ x\ {\isasymin}\ set\ l{\isachardot}\ f\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharparenright}\ {\isasymlongrightarrow}\ ListMax\ {\isacharparenleft}map\ f\ {\isacharparenleft}Cons\ a\ l{\isacharparenright}{\isacharparenright}\ \ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isachardot}IH\ \isacommand{by}\isamarkupfalse%
\ linarith\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
I use Type nat option to screen out a branch without a labelled node; however I still use ListMax assuming there
is only one node labelled by the second argument.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{inductive}\isamarkupfalse%
\ ListOfNone\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharprime}a\ option{\isacharparenright}\ list\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\ \isanewline
\ \ Nil{\isacharcolon}\ {\isachardoublequoteopen}ListOfNone\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
{\isacharbar}\ Cons\ {\isacharcolon}\ {\isachardoublequoteopen}ListOfNone\ n\ {\isasymLongrightarrow}\ ListOfNone\ {\isacharparenleft}None{\isacharhash}n{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ maxOption\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ option\ {\isasymRightarrow}\ nat\ option\ {\isasymRightarrow}\ nat\ option{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}maxOption\ None\ x\ {\isacharequal}\ x{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}maxOption\ {\isacharparenleft}Some\ n{\isacharparenright}\ x\ {\isacharequal}\ {\isacharparenleft}case\ x\ of\ Some\ m\ {\isasymRightarrow}\ Some\ {\isacharparenleft}max\ n\ m{\isacharparenright}\ {\isacharbar}\ None\ {\isasymRightarrow}\ Some\ n{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \isanewline
\isacommand{definition}\isamarkupfalse%
\ ListMaxOption\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}nat\ option{\isacharparenright}\ list\ {\isasymRightarrow}\ nat\ option{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}ListMaxOption\ l\ {\isacharequal}\ foldr\ maxOption\ l\ None{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ SucOption\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ option\ {\isasymRightarrow}\ nat\ option{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}SucOption\ n\ {\isacharequal}\ {\isacharparenleft}case\ n\ of\ None\ {\isasymRightarrow}\ None\ {\isacharbar}\ Some\ n\ {\isasymRightarrow}\ Some\ {\isacharparenleft}Suc\ n{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\isacommand{fun}\isamarkupfalse%
\ le{\isacharunderscore}option\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ option\ {\isasymRightarrow}\ nat\ option\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\ \ \isanewline
\ \ {\isachardoublequoteopen}le{\isacharunderscore}option\ None\ {\isacharunderscore}\ {\isacharequal}\ True{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}le{\isacharunderscore}option\ {\isacharparenleft}Some\ n{\isacharparenright}\ x\ {\isacharequal}\ {\isacharparenleft}case\ x\ of\ None\ {\isasymRightarrow}\ False\ {\isacharbar}\ Some\ m\ {\isasymRightarrow}\ n\ {\isasymle}\ m{\isacharparenright}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
We don't care None cases%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ lt{\isacharunderscore}option\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ option\ {\isasymRightarrow}\ nat\ option\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}lt{\isacharunderscore}option\ None\ {\isacharunderscore}\ {\isacharequal}\ False{\isachardoublequoteclose}\ \isanewline
{\isacharbar}\ {\isachardoublequoteopen}lt{\isacharunderscore}option\ {\isacharunderscore}\ None\ {\isacharequal}\ False{\isachardoublequoteclose}\ \ \isanewline
{\isacharbar}\ {\isachardoublequoteopen}lt{\isacharunderscore}option\ {\isacharparenleft}Some\ m{\isacharparenright}\ {\isacharparenleft}Some\ n{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}m\ {\isacharless}\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \isanewline
\isacommand{fun}\isamarkupfalse%
\ depth\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ nat\ option{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}depth\ Empty\ n\ {\isacharequal}\ None{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}depth\ {\isacharparenleft}Node\ n\ bl{\isacharparenright}\ m\ {\isacharequal}\ {\isacharparenleft}if\ n\ {\isacharequal}\ m\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ then\ {\isacharparenleft}Some\ {\isadigit{0}}{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ SucOption\ {\isacharparenleft}ListMaxOption\ {\isacharparenleft}map\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ depth\ x\ m{\isacharparenright}\ bl{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ H\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ nat\ set{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}H\ l\ {\isacharequal}\ {\isacharbraceleft}x{\isachardot}\ x\ {\isasymle}\ length\ l\ {\isasymand}\ {\isasymnot}\ {\isacharparenleft}nth\ {\isacharparenleft}False{\isacharhash}l{\isacharparenright}\ x{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ isHonest\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}isHonest\ l\ x\ {\isacharequal}\ {\isacharparenleft}{\isasymnot}\ {\isacharparenleft}nth\ {\isacharparenleft}False{\isacharhash}l{\isacharparenright}\ x{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ H{\isacharunderscore}{\isadigit{0}}\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymin}\ H\ l{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ H{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ getFrom{\isacharunderscore}suc{\isacharunderscore}eq{\isacharunderscore}H\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}x\ {\isacharless}\ length\ l\ {\isasymand}\ {\isasymnot}\ nth\ l\ x\ {\isasymlongleftrightarrow}\ Suc\ x\ {\isasymin}\ H\ l{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ H{\isacharunderscore}def\ less{\isacharunderscore}eq{\isacharunderscore}Suc{\isacharunderscore}le{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ ListSum\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ list\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}ListSum\ l\ {\isacharequal}\ foldr\ plus\ l\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ ListSum{\isacharunderscore}{\isadigit{0}}\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharcolon}{\isachardoublequoteopen}{\isacharparenleft}{\isasymforall}x\ {\isasymin}\ set\ l{\isachardot}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharparenright}\ {\isasymlongrightarrow}\ ListSum\ l\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ l{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ l{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\ \isanewline
\ \ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
No prunning used as we don't yet have an increasing tree in argument, but can improve it later%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ count{\isacharunderscore}node\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ nattree\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}count{\isacharunderscore}node\ {\isacharunderscore}\ Empty\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}count{\isacharunderscore}node\ m\ {\isacharparenleft}Node\ n\ bl{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}of{\isacharunderscore}bool\ {\isacharparenleft}m\ {\isacharequal}\ n{\isacharparenright}{\isacharparenright}\ {\isacharplus}\ ListSum\ {\isacharparenleft}map\ {\isacharparenleft}count{\isacharunderscore}node\ m{\isacharparenright}\ bl{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ count{\isacharunderscore}node{\isacharunderscore}Leaf\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharcolon}\ {\isachardoublequoteopen}Leaf\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymlongrightarrow}\ count{\isacharunderscore}node\ m\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\ of{\isacharunderscore}bool\ {\isacharparenleft}m\ {\isacharequal}\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Leaf\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymlongrightarrow}\ {\isacharparenleft}{\isasymforall}x\ {\isasymin}\ set\ l{\isachardot}\ count{\isacharunderscore}node\ m\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Leaf{\isacharunderscore}non{\isacharunderscore}ListOfEmpty\ count{\isacharunderscore}node{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Leaf\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymlongrightarrow}\ \ ListSum\ {\isacharparenleft}map\ {\isacharparenleft}count{\isacharunderscore}node\ m{\isacharparenright}\ l{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ ListSum{\isacharunderscore}{\isadigit{0}}\ Listmax{\isacharunderscore}ge\ le{\isacharunderscore}zero{\isacharunderscore}eq\ listmax{\isacharunderscore}{\isadigit{0}}{\isacharparenright}\ \ \ \ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ count{\isacharunderscore}node{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ presburger\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{definition}\isamarkupfalse%
\ unique{\isacharunderscore}node\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}unique{\isacharunderscore}node\ t\ n\ {\isacharequal}\ {\isacharparenleft}count{\isacharunderscore}node\ n\ t\ {\isacharequal}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
This function returns true only if each member in a set has one and only associated node.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ unique{\isacharunderscore}nodes{\isacharunderscore}by{\isacharunderscore}nat{\isacharunderscore}set\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nat\ set\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}unique{\isacharunderscore}nodes{\isacharunderscore}by{\isacharunderscore}nat{\isacharunderscore}set\ t\ s\ {\isacharequal}\ {\isacharparenleft}{\isasymforall}x\ {\isasymin}\ s{\isachardot}\ unique{\isacharunderscore}node\ t\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\isacommand{definition}\isamarkupfalse%
\ uniqueH{\isacharunderscore}tree\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ bool\ list\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}uniqueH{\isacharunderscore}tree\ t\ l\ {\isacharequal}\ \ unique{\isacharunderscore}nodes{\isacharunderscore}by{\isacharunderscore}nat{\isacharunderscore}set\ t\ {\isacharparenleft}H\ l{\isacharparenright}{\isachardoublequoteclose}\ \ \ \ \isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ uniqueH{\isacharunderscore}tree{\isacharunderscore}in{\isacharunderscore}imp{\isacharunderscore}l\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}\ x\ {\isasymin}\ H\ l{\isachardot}\ uniqueH{\isacharunderscore}tree\ t\ l\ {\isasymlongrightarrow}\ unique{\isacharunderscore}node\ t\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ uniqueH{\isacharunderscore}tree{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ uniqueH{\isacharunderscore}tree{\isacharunderscore}in{\isacharunderscore}imp{\isacharunderscore}r\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymforall}\ x\ {\isasymin}\ H\ l{\isachardot}\ unique{\isacharunderscore}node\ t\ x{\isacharparenright}\ {\isasymlongrightarrow}\ uniqueH{\isacharunderscore}tree\ t\ l{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ uniqueH{\isacharunderscore}tree{\isacharunderscore}def\ unique{\isacharunderscore}nodes{\isacharunderscore}by{\isacharunderscore}nat{\isacharunderscore}set{\isachardot}simps\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{fun}\isamarkupfalse%
\ max{\isacharunderscore}node\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}max{\isacharunderscore}node\ Empty\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}max{\isacharunderscore}node\ {\isacharparenleft}Node\ n\ bl{\isacharparenright}\ {\isacharequal}\ ListMax\ {\isacharparenleft}n\ {\isacharhash}\ {\isacharparenleft}map\ max{\isacharunderscore}node\ bl{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ max{\isacharunderscore}node{\isacharunderscore}max\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}\ m{\isachardot}\ max{\isacharunderscore}node\ t\ {\isacharless}\ m\ \ {\isasymlongrightarrow}\ count{\isacharunderscore}node\ m\ t\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ t{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ Empty\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\ \isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Node\ x{\isadigit{1}}\ x{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}\ {\isachardoublequoteopen}max{\isacharunderscore}node\ {\isacharparenleft}Node\ x{\isadigit{1}}\ x{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ ListMax\ {\isacharparenleft}x{\isadigit{1}}\ {\isacharhash}\ {\isacharparenleft}map\ max{\isacharunderscore}node\ x{\isadigit{2}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x\ {\isasymin}\ set\ x{\isadigit{2}}{\isachardot}\ max{\isacharunderscore}node\ x\ {\isasymle}\ max{\isacharunderscore}node\ {\isacharparenleft}Node\ x{\isadigit{1}}\ x{\isadigit{2}}{\isacharparenright}\ {\isasymand}\ x{\isadigit{1}}\ {\isasymle}\ max{\isacharunderscore}node\ {\isacharparenleft}Node\ x{\isadigit{1}}\ x{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}\ {\isasymforall}y\ {\isasymin}\ set\ x{\isadigit{2}}\ {\isachardot}\ max{\isacharunderscore}node\ {\isacharparenleft}Node\ x{\isadigit{1}}\ x{\isadigit{2}}{\isacharparenright}{\isacharless}\ x\ {\isasymlongrightarrow}\ max{\isacharunderscore}node\ y\ {\isacharless}\ x\ {\isasymand}\ x{\isadigit{1}}\ {\isacharless}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ le{\isacharunderscore}less{\isacharunderscore}trans\ \isacommand{by}\isamarkupfalse%
\ blast\ \ \isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}\ {\isasymforall}y\ {\isasymin}\ set\ x{\isadigit{2}}\ {\isachardot}\ max{\isacharunderscore}node\ {\isacharparenleft}Node\ x{\isadigit{1}}\ x{\isadigit{2}}{\isacharparenright}{\isacharless}\ x\ {\isasymlongrightarrow}\ count{\isacharunderscore}node\ x\ y\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ Node{\isachardot}IH{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}\ max{\isacharunderscore}node\ {\isacharparenleft}Node\ x{\isadigit{1}}\ x{\isadigit{2}}{\isacharparenright}{\isacharless}\ x\ {\isasymlongrightarrow}\ count{\isacharunderscore}node\ x\ {\isacharparenleft}Node\ x{\isadigit{1}}\ x{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ \ ListSum\ {\isacharparenleft}map\ {\isacharparenleft}count{\isacharunderscore}node\ x{\isacharparenright}\ x{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ Listmax{\isacharunderscore}ge\ a\ add{\isachardot}commute\ add{\isacharunderscore}cancel{\isacharunderscore}left{\isacharunderscore}right\ count{\isacharunderscore}node{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ list{\isachardot}set{\isacharunderscore}intros{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ not{\isacharunderscore}le\ of{\isacharunderscore}bool{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ListSum{\isacharunderscore}{\isadigit{0}}\ {\isacartoucheopen}{\isasymforall}x{\isachardot}\ {\isasymforall}y{\isasymin}set\ x{\isadigit{2}}{\isachardot}\ max{\isacharunderscore}node\ {\isacharparenleft}Node\ x{\isadigit{1}}\ x{\isadigit{2}}{\isacharparenright}\ {\isacharless}\ x\ {\isasymlongrightarrow}\ count{\isacharunderscore}node\ x\ y\ {\isacharequal}\ {\isadigit{0}}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{fun}\isamarkupfalse%
\ increasing{\isacharunderscore}depth{\isacharunderscore}H\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ bool\ list\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}increasing{\isacharunderscore}depth{\isacharunderscore}H\ t\ l\ {\isacharequal}\ {\isacharparenleft}{\isasymforall}x\ {\isasymin}\ H\ l{\isachardot}\ {\isasymforall}y\ {\isasymin}\ H\ l{\isachardot}\ x\ {\isacharless}\ y\ {\isasymlongrightarrow}\ \ lt{\isacharunderscore}option\ {\isacharparenleft}depth\ t\ x{\isacharparenright}\ \ {\isacharparenleft}depth\ t\ y{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{inductive}\isamarkupfalse%
\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}depth{\isacharunderscore}{\isadigit{0}}\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharcolon}\ {\isachardoublequoteopen}root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}\ n\ {\isasymlongrightarrow}\ depth\ n\ {\isadigit{0}}\ {\isacharequal}\ Some\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ depth{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}{\isachardot}cases{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
F |- w%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ isFork\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ nattree\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}isFork\ w\ F\ {\isacharequal}\ {\isacharparenleft}{\isacharparenleft}length\ w\ {\isasymge}\ max{\isacharunderscore}node\ F{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}increasing{\isacharunderscore}tree\ F{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}uniqueH{\isacharunderscore}tree\ F\ w{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}increasing{\isacharunderscore}depth{\isacharunderscore}H\ F\ w{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}\ F{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ isFork{\isacharunderscore}max{\isacharunderscore}not{\isacharunderscore}exceed\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharcolon}\ {\isachardoublequoteopen}isFork\ w\ F\ {\isasymlongrightarrow}\ length\ w\ {\isasymge}\ max{\isacharunderscore}node\ F{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ isFork{\isacharunderscore}root{\isacharunderscore}{\isadigit{0}}\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharcolon}\ {\isachardoublequoteopen}isFork\ w\ F\ {\isasymlongrightarrow}\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}\ F{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ isFork{\isacharunderscore}increasing{\isacharunderscore}tree\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharcolon}\ {\isachardoublequoteopen}isFork\ w\ F\ {\isasymlongrightarrow}\ increasing{\isacharunderscore}tree\ F{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ isFork{\isachardot}simps\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ isFork{\isacharunderscore}uniqueH{\isacharunderscore}tree\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharcolon}\ {\isachardoublequoteopen}isFork\ w\ F\ {\isasymlongrightarrow}\ {\isacharparenleft}{\isasymforall}x\ {\isasymin}\ H\ w{\isachardot}\ unique{\isacharunderscore}node\ F\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ isFork{\isachardot}elims{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ uniqueH{\isacharunderscore}tree{\isacharunderscore}in{\isacharunderscore}imp{\isacharunderscore}l{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ isFork{\isacharunderscore}increasing{\isacharunderscore}depth{\isacharunderscore}H\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharcolon}\ \isanewline
{\isachardoublequoteopen}isFork\ w\ F\ {\isasymlongrightarrow}\ {\isacharparenleft}{\isasymforall}\ x\ {\isasymin}\ H\ w{\isachardot}\ {\isasymforall}\ y\ {\isasymin}\ H\ w{\isachardot}\ x\ {\isacharless}\ y\ {\isasymlongrightarrow}\ lt{\isacharunderscore}option\ {\isacharparenleft}depth\ F\ x{\isacharparenright}\ {\isacharparenleft}depth\ F\ y{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ increasing{\isacharunderscore}depth{\isacharunderscore}H{\isachardot}elims{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ isFork{\isachardot}elims{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{fun}\isamarkupfalse%
\ getLabelFromTine\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nat\ list\ {\isasymRightarrow}\ nat\ list{\isachardoublequoteclose}\ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}getLabelFromTine\ Empty\ l\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}getLabelFromTine\ {\isacharunderscore}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}getLabelFromTine\ {\isacharparenleft}Node\ {\isacharunderscore}\ l{\isacharparenright}\ {\isacharparenleft}x{\isacharhash}xs{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}if\ x\ {\isasymge}\ length\ l\ then\ {\isacharbrackleft}{\isacharbrackright}\ else\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}case\ nth\ l\ x\ of\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Empty\ {\isasymRightarrow}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharbar}\ {\isacharparenleft}{\isacharasterisk}it\ runs\ out\ of\ nodes\ before\ we\ can\ trace\ down\ all\ paths{\isacharasterisk}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Node\ n\ {\isacharunderscore}\ {\isasymRightarrow}\ n\ {\isacharhash}\ getLabelFromTine\ {\isacharparenleft}hd\ {\isacharparenleft}drop\ x\ l{\isacharparenright}{\isacharparenright}\ xs{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
This function provides a set of all path possible, starting from a root by comparing between
the length of lists of all choices of edges and lists of their labels.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ set{\isacharunderscore}of{\isacharunderscore}tines\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ {\isacharparenleft}nat\ list{\isacharparenright}\ set{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}tines\ t\ \ {\isacharequal}\ {\isacharbraceleft}tine{\isachardot}\ length\ tine\ {\isacharequal}\ length\ {\isacharparenleft}getLabelFromTine\ t\ tine{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\ \ \isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ list\ {\isasymRightarrow}\ nat\ list\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharunderscore}\ {\isacharequal}\ True{\isachardoublequoteclose}\ \isanewline
{\isacharbar}\ {\isachardoublequoteopen}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ {\isacharunderscore}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ True{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ {\isacharparenleft}x{\isacharhash}xs{\isacharparenright}\ {\isacharparenleft}y{\isacharhash}ys{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}x{\isasymnoteq}y{\isacharparenright}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
Definition 4.11: flatTree%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ flatTree\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ {\isachardoublequoteopen}flatTree\ F\ {\isacharequal}\ \isanewline
{\isacharparenleft}{\isasymexists}\ t{\isadigit{1}}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ F{\isachardot}\ \isanewline
\ {\isasymexists}\ t{\isadigit{2}}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ F{\isachardot}\ \isanewline
\ length\ t{\isadigit{1}}\ {\isacharequal}\ length\ t{\isadigit{2}}\ \isanewline
\ {\isasymand}\ length\ t{\isadigit{1}}\ {\isacharequal}\ height\ F\ \isanewline
\ {\isasymand}\ edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t{\isadigit{1}}\ t{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\ \ \isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Leaf{\isacharunderscore}imp{\isacharunderscore}nil{\isacharunderscore}label{\isacharunderscore}tine\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ \isakeyword{assumes}\ {\isachardoublequoteopen}Leaf\ {\isacharparenleft}Node\ n\ l{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}getLabelFromTine\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ t\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ t{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ getLabelFromTine{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ list{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}a\ {\isasymge}\ length\ l{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ getLabelFromTine{\isachardot}simps{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ local{\isachardot}Cons\ \isacommand{by}\isamarkupfalse%
\ presburger\ \isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharless}\ length\ l{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ False\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}nth\ l\ a\ {\isacharequal}\ Empty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Leaf{\isacharunderscore}non{\isacharunderscore}ListOfEmpty\ assms\ nth{\isacharunderscore}mem\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ local{\isachardot}Cons{\isacharparenright}\ \ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ flatTree{\isacharunderscore}trivial\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ \isakeyword{assumes}\ {\isachardoublequoteopen}Leaf\ {\isacharparenleft}Node\ n\ l{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}flatTree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}tines\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}tine{\isachardot}\ length\ tine\ {\isacharequal}\ length\ {\isacharparenleft}getLabelFromTine\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ tine{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ set{\isacharunderscore}of{\isacharunderscore}tines{\isachardot}elims{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}tines\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}tine{\isachardot}\ length\ tine\ {\isacharequal}\ length\ {\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ lifting{\isacharparenright}\ Collect{\isacharunderscore}cong\ Leaf{\isacharunderscore}imp{\isacharunderscore}nil{\isacharunderscore}label{\isacharunderscore}tine\ assms\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}tines\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}tine{\isachardot}\ length\ tine\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharparenright}\ {\isacartoucheopen}set{\isacharunderscore}of{\isacharunderscore}tines\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}tine{\isachardot}\ length\ tine\ {\isacharequal}\ length\ {\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}{\isacartoucheclose}\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}tines\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}flatTree\ {\isacharparenleft}Node\ n\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ assms\ edge{\isacharunderscore}disjoint{\isacharunderscore}tines{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ flatTree{\isachardot}simps\ height{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ singletonI{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \ \ \ \ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ isForkable\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}isForkable\ w\ {\isacharequal}\ {\isacharparenleft}{\isasymexists}F{\isachardot}\ isFork\ w\ F\ {\isasymand}\ flatTree\ F{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\isacommand{definition}\isamarkupfalse%
\ flatFork\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ nattree\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}flatFork\ w\ F\ {\isacharequal}\ {\isacharparenleft}isFork\ w\ F\ {\isasymand}\ flatTree\ F{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{inductive}\isamarkupfalse%
\ ListOfAdverse\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ Nil\ {\isacharcolon}\ {\isachardoublequoteopen}ListOfAdverse\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ \ \isanewline
{\isacharbar}\ Cons\ {\isacharcolon}\ {\isachardoublequoteopen}ListOfAdverse\ xs\ {\isasymLongrightarrow}\ ListOfAdverse\ {\isacharparenleft}True{\isacharhash}xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ ListOfAdverse{\isacharunderscore}all{\isacharunderscore}True\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}ListOfAdverse\ w\ {\isasymlongrightarrow}\ {\isacharparenleft}{\isasymforall}\ x\ {\isasymin}\ set\ w{\isachardot}\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ w{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ w{\isacharparenright}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}ListOfAdverse\ {\isacharparenleft}a{\isacharhash}w{\isacharparenright}\ {\isasymlongrightarrow}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ListOfAdverse{\isachardot}cases\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isachardot}IH\ ListOfAdverse{\isachardot}cases\ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ all{\isacharunderscore}True{\isacharunderscore}ListOfAdverse\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymforall}\ x\ {\isasymin}\ set\ w{\isachardot}\ x{\isacharparenright}\ {\isasymlongrightarrow}\ ListOfAdverse\ w{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ w{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ ListOfAdverse{\isachardot}Nil{\isacharparenright}\ \isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ w{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharequal}\ True\ {\isasymand}\ {\isacharparenleft}{\isasymforall}x\ {\isasymin}\ set\ w{\isachardot}\ x{\isacharparenright}\ {\isasymlongrightarrow}\ ListOfAdverse\ {\isacharparenleft}a{\isacharhash}w{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ ListOfAdverse{\isachardot}Cons\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ singleton{\isacharunderscore}H{\isacharunderscore}ListOfAdverse\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}ListOfAdverse\ w\ {\isasymlongrightarrow}\ H\ w\ {\isacharequal}\ {\isacharbraceleft}{\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ w{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ H{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ w{\isacharparenright}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}ListOfAdverse\ {\isacharparenleft}a{\isacharhash}w{\isacharparenright}\ {\isasymlongrightarrow}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ListOfAdverse{\isachardot}cases\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}ListOfAdverse\ {\isacharparenleft}a{\isacharhash}w{\isacharparenright}\ {\isasymlongrightarrow}\ {\isacharparenleft}{\isasymforall}\ x{\isachardot}\ x\ {\isasymle}\ length\ w\ {\isasymlongrightarrow}\ nth\ {\isacharparenleft}False{\isacharhash}{\isacharparenleft}a{\isacharhash}w{\isacharparenright}{\isacharparenright}\ x\ {\isacharequal}\ nth\ {\isacharparenleft}False{\isacharhash}w{\isacharparenright}\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ ListOfAdverse{\isacharunderscore}all{\isacharunderscore}True\ add{\isachardot}right{\isacharunderscore}neutral\ add{\isacharunderscore}Suc{\isacharunderscore}right\ insert{\isacharunderscore}iff\ le{\isacharunderscore}SucI\ list{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isadigit{5}}{\isacharparenright}\ list{\isachardot}size{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ nth{\isacharunderscore}equal{\isacharunderscore}first{\isacharunderscore}eq{\isacharparenright}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}ListOfAdverse\ {\isacharparenleft}a{\isacharhash}w{\isacharparenright}\ {\isasymlongrightarrow}\ {\isacharparenleft}nth\ {\isacharparenleft}False{\isacharhash}{\isacharparenleft}a{\isacharhash}w{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}length\ {\isacharparenleft}a{\isacharhash}w{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ ListOfAdverse{\isacharunderscore}all{\isacharunderscore}True\ length{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}conv\ linear\ list{\isachardot}distinct{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ nth{\isacharunderscore}equal{\isacharunderscore}first{\isacharunderscore}eq{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ Collect{\isacharunderscore}cong\ H{\isacharunderscore}{\isadigit{0}}\ H{\isacharunderscore}def\ ListOfAdverse{\isacharunderscore}all{\isacharunderscore}True\ mem{\isacharunderscore}Collect{\isacharunderscore}eq\ nth{\isacharunderscore}equal{\isacharunderscore}first{\isacharunderscore}eq\ singleton{\isacharunderscore}conv{\isacharparenright}\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ ListOfEmpty{\isacharunderscore}max{\isacharunderscore}node{\isacharunderscore}ListMax{\isacharunderscore}{\isadigit{0}}\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}ListOfEmpty\ l{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}ListMax\ {\isacharparenleft}map\ max{\isacharunderscore}node\ l{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Leaf{\isachardot}simps\ Leaf{\isacharunderscore}non{\isacharunderscore}ListOfEmpty\ assms\ listmax{\isacharunderscore}{\isadigit{0}}\ map{\isacharunderscore}eq{\isacharunderscore}map{\isacharunderscore}tailrec\ max{\isacharunderscore}node{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ max{\isacharunderscore}node{\isacharunderscore}Leaf\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}Leaf\ {\isacharparenleft}Node\ n\ l{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}max{\isacharunderscore}node\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\ n{\isachardoublequoteclose}\ \ \ \ \isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}max{\isacharunderscore}node\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\ ListMax\ {\isacharparenleft}n{\isacharhash}{\isacharparenleft}map\ max{\isacharunderscore}node\ l{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}max{\isacharunderscore}node\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\ max\ n\ {\isacharparenleft}ListMax\ {\isacharparenleft}map\ max{\isacharunderscore}node\ l{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ ListMax{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}max{\isacharunderscore}node\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\ n\ {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ Leaf{\isachardot}simps\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ flatFork{\isacharunderscore}Trivial\ {\isacharcolon}\ \isakeyword{assumes}\ {\isachardoublequoteopen}Leaf\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}ListOfAdverse\ w{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}flatFork\ w\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}{\isachardoublequoteclose}\ \ \isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}flatTree\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ flatTree{\isacharunderscore}trivial\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ prem{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}length\ w\ {\isasymge}\ max{\isacharunderscore}node\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ max{\isacharunderscore}node{\isacharunderscore}Leaf\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ prem{\isadigit{2}}{\isacharcolon}\ {\isachardoublequoteopen}increasing{\isacharunderscore}tree\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Leaf{\isachardot}cases\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ increasing{\isacharunderscore}tree{\isacharunderscore}branch{\isacharunderscore}list{\isacharunderscore}of{\isacharunderscore}empty\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}count{\isacharunderscore}node\ {\isadigit{0}}\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}\ {\isacharequal}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}full{\isacharunderscore}types{\isacharparenright}\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ count{\isacharunderscore}node{\isacharunderscore}Leaf\ of{\isacharunderscore}bool{\isacharunderscore}eq{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}H\ w\ {\isacharequal}\ {\isacharbraceleft}{\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ singleton{\isacharunderscore}H{\isacharunderscore}ListOfAdverse\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ prem{\isadigit{3}}{\isacharcolon}\ {\isachardoublequoteopen}uniqueH{\isacharunderscore}tree\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}\ w{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ count{\isacharunderscore}node{\isacharunderscore}Leaf\ of{\isacharunderscore}bool{\isacharunderscore}eq{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ singletonD\ uniqueH{\isacharunderscore}tree{\isacharunderscore}in{\isacharunderscore}imp{\isacharunderscore}r\ unique{\isacharunderscore}node{\isacharunderscore}def{\isacharparenright}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ prem{\isadigit{4}}{\isacharcolon}{\isachardoublequoteopen}increasing{\isacharunderscore}depth{\isacharunderscore}H\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ {\isacartoucheopen}H\ w\ {\isacharequal}\ {\isacharbraceleft}{\isadigit{0}}{\isacharbraceright}{\isacartoucheclose}{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}{\isachardot}intros{\isacharparenright}\ \ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}flatTree\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}{\isacartoucheclose}\ flatFork{\isacharunderscore}def\ isFork{\isachardot}elims{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ prem{\isadigit{1}}\ prem{\isadigit{2}}\ prem{\isadigit{3}}\ prem{\isadigit{4}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ forkable{\isacharunderscore}eq{\isacharunderscore}exist{\isacharunderscore}flatfork\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharcolon}\ {\isachardoublequoteopen}isForkable\ w\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\isasymexists}F{\isachardot}\ flatFork\ w\ F{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ flatFork{\isacharunderscore}def\ isForkable{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Definition 4.13 is really tricky as we have to traverse F and F' whether it holds that F \<subseteq> F' at 
the same time.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ isPrefix{\isacharunderscore}list\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}a\ list\ {\isasymRightarrow}\ {\isacharprime}a\ list\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}isPrefix{\isacharunderscore}list\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharunderscore}\ {\isacharequal}\ True{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}isPrefix{\isacharunderscore}list\ {\isacharparenleft}l{\isacharhash}ls{\isacharparenright}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ False{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}isPrefix{\isacharunderscore}list\ {\isacharparenleft}l{\isacharhash}ls{\isacharparenright}\ {\isacharparenleft}r{\isacharhash}rs{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isacharparenleft}l{\isacharequal}r{\isacharparenright}\ {\isasymand}\ isPrefix{\isacharunderscore}list\ ls\ rs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\isacommand{definition}\isamarkupfalse%
\ isPrefix{\isacharunderscore}tine\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nattree\ {\isasymRightarrow}\ nat\ list\ {\isasymRightarrow}\ nat\ list\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ {\isachardoublequoteopen}isPrefix{\isacharunderscore}tine\ nt{\isadigit{1}}\ nt{\isadigit{2}}\ t{\isadigit{1}}\ t{\isadigit{2}}\ {\isacharequal}\ \isanewline
{\isacharparenleft}isPrefix{\isacharunderscore}list\ t{\isadigit{1}}\ t{\isadigit{2}}\ {\isasymand}\ isPrefix{\isacharunderscore}list\ {\isacharparenleft}getLabelFromTine\ nt{\isadigit{1}}\ t{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}getLabelFromTine\ nt{\isadigit{2}}\ t{\isadigit{2}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \isanewline
\isacommand{definition}\isamarkupfalse%
\ isPrefix{\isacharunderscore}tree\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nattree\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}isPrefix{\isacharunderscore}tree\ nt{\isadigit{1}}\ nt{\isadigit{2}}\ {\isacharequal}\isanewline
\ \ \ \ {\isacharparenleft}{\isasymforall}t{\isadigit{1}}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ nt{\isadigit{1}}{\isachardot}\ {\isasymforall}t{\isadigit{2}}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ nt{\isadigit{2}}{\isachardot}\ isPrefix{\isacharunderscore}list\ t{\isadigit{1}}\ t{\isadigit{2}}\ \isanewline
\ \ \ \ {\isasymlongrightarrow}\ isPrefix{\isacharunderscore}tine\ nt{\isadigit{1}}\ nt{\isadigit{2}}\ t{\isadigit{1}}\ t{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
as this can consider from any list of natural numbers.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ isPrefix{\isacharunderscore}fork\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ bool\ list\ {\isasymRightarrow}\ nattree\ {\isasymRightarrow}\ nattree\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}isPrefix{\isacharunderscore}fork\ w{\isadigit{1}}\ w{\isadigit{2}}\ nt{\isadigit{1}}\ nt{\isadigit{2}}\ {\isacharequal}\ \isanewline
\ \ \ \ {\isacharparenleft}isFork\ w{\isadigit{1}}\ nt{\isadigit{1}}\ {\isasymand}\ isFork\ w{\isadigit{2}}\ nt{\isadigit{2}}\ {\isasymand}\ isPrefix{\isacharunderscore}list\ w{\isadigit{1}}\ w{\isadigit{2}}\ {\isasymand}\ isPrefix{\isacharunderscore}tree\ nt{\isadigit{1}}\ nt{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
Definition 4.14%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ closedFork{\isacharunderscore}Hgiven\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nat\ set\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}closedFork{\isacharunderscore}Hgiven\ Empty\ {\isacharunderscore}\ {\isacharequal}\ True{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}closedFork{\isacharunderscore}Hgiven\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ h\ {\isacharequal}\ {\isacharparenleft}if\ ListOfEmpty\ l\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ then\ {\isacharparenleft}n\ {\isasymin}\ h{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ foldr\ conj\ {\isacharparenleft}map\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ closedFork{\isacharunderscore}Hgiven\ x\ h{\isacharparenright}\ l{\isacharparenright}\ True{\isacharparenright}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
A closed fork has to be a fork of a certain string and closed in regard to that string.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ closedFork\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ bool\ list\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}closedFork\ F\ w\ {\isacharequal}\ {\isacharparenleft}isFork\ w\ F\ {\isasymand}\ closedFork{\isacharunderscore}Hgiven\ F\ {\isacharparenleft}H\ w{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ closedFork{\isacharunderscore}ListOfAdverse\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}Leaf\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}ListOfAdverse\ w{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}closedFork\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}\ w{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}closedFork{\isacharunderscore}Hgiven\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}\ {\isacharparenleft}H\ w{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ H{\isacharunderscore}{\isadigit{0}}\ Leaf{\isachardot}cases\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ closedFork{\isacharunderscore}Hgiven{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ nattree{\isachardot}inject{\isacharparenright}\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ closedFork{\isacharunderscore}def\ flatFork{\isacharunderscore}Trivial\ flatFork{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ not{\isacharunderscore}ListOfAdverse{\isacharunderscore}not{\isacharunderscore}trivial{\isacharunderscore}fork\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}Leaf\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ ListOfAdverse\ w{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymnot}\ isFork\ w\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}\ x\ {\isasymin}\ set\ w{\isachardot}\ {\isasymnot}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ all{\isacharunderscore}True{\isacharunderscore}ListOfAdverse\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}\ x{\isachardot}\ x\ {\isachargreater}\ {\isadigit{0}}\ {\isasymand}\ x\ {\isasymle}\ length\ w\ {\isasymand}\ {\isasymnot}\ {\isacharparenleft}nth\ {\isacharparenleft}False{\isacharhash}w{\isacharparenright}\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Suc{\isacharunderscore}leI\ in{\isacharunderscore}set{\isacharunderscore}conv{\isacharunderscore}nth\ nth{\isacharunderscore}Cons{\isacharunderscore}Suc\ zero{\isacharunderscore}less{\isacharunderscore}Suc{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}\ x{\isachardot}\ x\ {\isachargreater}\ {\isadigit{0}}\ {\isasymand}\ x\ {\isasymin}\ H\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ H{\isacharunderscore}def{\isacharparenright}\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ uniqueH{\isacharunderscore}tree\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ One{\isacharunderscore}nat{\isacharunderscore}def\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ max{\isacharunderscore}node{\isacharunderscore}Leaf\ max{\isacharunderscore}node{\isacharunderscore}max\ nat{\isachardot}simps{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ uniqueH{\isacharunderscore}tree{\isacharunderscore}in{\isacharunderscore}imp{\isacharunderscore}l\ unique{\isacharunderscore}node{\isacharunderscore}def{\isacharparenright}\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ isFork{\isachardot}simps\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \ \ \isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ Leaf{\isacharunderscore}inp{\isacharunderscore}ListOfAdverse{\isacharunderscore}trivial{\isacharunderscore}fork\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}Leaf\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}ListOfAdverse\ w\ {\isasymlongleftrightarrow}\ isFork\ w\ {\isacharparenleft}Node\ {\isadigit{0}}\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ flatFork{\isacharunderscore}Trivial\ flatFork{\isacharunderscore}def\ not{\isacharunderscore}ListOfAdverse{\isacharunderscore}not{\isacharunderscore}trivial{\isacharunderscore}fork\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
From Definition 4.15, gap reserve and reach depend on a fork and a characteristic string.%
\end{isamarkuptext}\isamarkuptrue%
%
\begin{isamarkuptext}%
A gap of a tine is a difference between its length and the longest tine's.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ gap\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ nat\ list\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}gap\ nt\ tine\ {\isacharequal}\ height\ nt\ {\isacharminus}\ length\ tine{\isachardoublequoteclose}%
\begin{isamarkuptext}%
A reserve of a tine is the number of adversarial nodes after the last node of the tine.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ reserve\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ nat\ list\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}reserve\ w\ labeledTine\ {\isacharequal}\ foldr\ {\isacharparenleft}{\isasymlambda}x{\isachardot}{\isacharparenleft}plus\ {\isacharparenleft}of{\isacharunderscore}bool\ x{\isacharparenright}{\isacharparenright}{\isacharparenright}\ \ {\isacharparenleft}drop\ {\isacharparenleft}ListMax\ labeledTine{\isacharparenright}\ w{\isacharparenright}\ {\isadigit{0}}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
A reach of a tine is simply a difference between its reserve and gap.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ reach\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ bool\ list\ {\isasymRightarrow}\ nat\ list\ {\isasymRightarrow}\ int{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}reach\ nt\ w\ tine\ {\isacharequal}\ int\ {\isacharparenleft}reserve\ w\ {\isacharparenleft}getLabelFromTine\ nt\ tine{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ int\ {\isacharparenleft}gap\ nt\ tine{\isacharparenright}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
lambda and mu (or called margin) from Definition 4.16.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ lambda\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ bool\ list\ {\isasymRightarrow}\ int{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}lambda\ t\ w\ {\isacharequal}\ Max\ {\isacharbraceleft}r{\isachardot}\ {\isasymexists}\ x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ t{\isachardot}\ r\ {\isacharequal}\ reach\ t\ w\ x{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ ListOfAdverse{\isacharunderscore}count{\isacharunderscore}eq{\isacharunderscore}length\ {\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}ListOfAdverse\ w\ {\isasymlongrightarrow}\ {\isacharparenleft}foldr\ {\isacharparenleft}{\isasymlambda}x{\isachardot}{\isacharparenleft}plus\ {\isacharparenleft}of{\isacharunderscore}bool\ x{\isacharparenright}{\isacharparenright}{\isacharparenright}\ w\ {\isadigit{0}}{\isacharparenright}\ {\isacharequal}\ length\ w{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ w{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ w{\isacharparenright}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}ListOfAdverse\ {\isacharparenleft}Cons\ a\ w{\isacharparenright}\ {\isasymlongrightarrow}\ a\ {\isasymand}\ ListOfAdverse\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ListOfAdverse{\isachardot}cases\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}ListOfAdverse\ {\isacharparenleft}Cons\ a\ w{\isacharparenright}\ {\isasymlongrightarrow}\ a\ {\isasymand}\ {\isacharparenleft}foldr\ {\isacharparenleft}{\isasymlambda}x{\isachardot}{\isacharparenleft}plus\ {\isacharparenleft}of{\isacharunderscore}bool\ x{\isacharparenright}{\isacharparenright}{\isacharparenright}\ w\ {\isadigit{0}}{\isacharparenright}\ {\isacharequal}\ length\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isachardot}IH\ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}ListOfAdverse\ {\isacharparenleft}Cons\ a\ w{\isacharparenright}\ {\isasymlongrightarrow}\ foldr\ {\isacharparenleft}{\isasymlambda}x{\isachardot}{\isacharparenleft}plus\ {\isacharparenleft}of{\isacharunderscore}bool\ x{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}a\ {\isacharhash}\ w{\isacharparenright}\ {\isadigit{0}}\ {\isacharequal}\ {\isacharparenleft}{\isasymlambda}x{\isachardot}{\isacharparenleft}plus\ {\isacharparenleft}of{\isacharunderscore}bool\ x{\isacharparenright}{\isacharparenright}{\isacharparenright}\ a\ {\isacharparenleft}length\ w{\isacharparenright}\ {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ foldr{\isacharunderscore}Cons\ o{\isacharunderscore}apply{\isacharparenright}\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}full{\isacharunderscore}types{\isacharparenright}\ One{\isacharunderscore}nat{\isacharunderscore}def\ {\isacartoucheopen}ListOfAdverse\ {\isacharparenleft}a\ {\isacharhash}\ w{\isacharparenright}\ {\isasymlongrightarrow}\ a\ {\isasymand}\ ListOfAdverse\ w{\isacartoucheclose}\ list{\isachardot}size{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ of{\isacharunderscore}bool{\isacharunderscore}eq{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ semiring{\isacharunderscore}normalization{\isacharunderscore}rules{\isacharparenleft}{\isadigit{2}}{\isadigit{4}}{\isacharparenright}{\isacharparenright}\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ lambda{\isacharunderscore}no{\isacharunderscore}honest\ {\isacharcolon}\ \isakeyword{assumes}\ {\isachardoublequoteopen}ListOfAdverse\ w{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}t{\isachardot}\ isFork\ w\ t\ {\isasymand}\ lambda\ t\ w\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ l\ \isakeyword{where}\ {\isachardoublequoteopen}ListOfEmpty\ l{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ ListOfEmpty{\isachardot}Nil\ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ t\ \isakeyword{where}\ a{\isacharcolon}{\isachardoublequoteopen}Leaf\ t\ {\isasymand}\ t\ {\isacharequal}\ Node\ {\isadigit{0}}\ l\ {\isasymand}\ isFork\ w\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Leaf{\isachardot}intros\ Leaf{\isacharunderscore}inp{\isacharunderscore}ListOfAdverse{\isacharunderscore}trivial{\isacharunderscore}fork\ {\isacartoucheopen}ListOfEmpty\ l{\isacartoucheclose}\ assms\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\isachardoublequoteopen}gap\ t\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacartoucheopen}Leaf\ t\ {\isasymand}\ t\ {\isacharequal}\ Node\ {\isadigit{0}}\ l\ {\isasymand}\ isFork\ w\ t{\isacartoucheclose}\ gap{\isacharunderscore}def\ height{\isacharunderscore}Leaf\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ minus{\isacharunderscore}nat{\isachardot}diff{\isacharunderscore}{\isadigit{0}}{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}reserve\ w\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ reachge{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}reach\ t\ w\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}gap\ t\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isacartoucheclose}\ reach{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ tine{\isachardot}\ getLabelFromTine\ t\ tine\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Leaf{\isacharunderscore}imp{\isacharunderscore}nil{\isacharunderscore}label{\isacharunderscore}tine\ a\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ tine{\isachardot}\ length\ {\isacharparenleft}getLabelFromTine\ t\ tine{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}tines\ t\ {\isacharequal}\ {\isacharbraceleft}{\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ exist{\isacharcolon}\ {\isachardoublequoteopen}{\isasymexists}\ x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ t{\isachardot}\ reach\ t\ w\ x\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ reachge{\isadigit{0}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ all{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}\ x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ t{\isachardot}\ reach\ t\ w\ x\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}set{\isacharunderscore}of{\isacharunderscore}tines\ t\ {\isacharequal}\ {\isacharbraceleft}{\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}r{\isachardot}\ {\isasymexists}\ x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ t{\isachardot}\ r\ {\isacharequal}\ reach\ t\ w\ x{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}r{\isachardot}\ r\ {\isacharequal}\ reach\ t\ w\ {\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}set{\isacharunderscore}of{\isacharunderscore}tines\ t\ {\isacharequal}\ {\isacharbraceleft}{\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}r{\isachardot}\ {\isasymexists}\ x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ t{\isachardot}\ r\ {\isacharequal}\ reach\ t\ w\ x{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}r{\isachardot}\ r\ {\isacharequal}\ int\ {\isacharparenleft}reserve\ w\ {\isacharparenleft}getLabelFromTine\ t\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ int\ {\isacharparenleft}gap\ t\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ reach{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}r{\isachardot}\ {\isasymexists}\ x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ t{\isachardot}\ r\ {\isacharequal}\ reach\ t\ w\ x{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}r{\isachardot}\ r\ {\isacharequal}\ int\ {\isacharparenleft}reserve\ w\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}\ {\isacharminus}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ a\ b\ getLabelFromTine{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ of{\isacharunderscore}nat{\isacharunderscore}{\isadigit{0}}{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}r{\isachardot}\ {\isasymexists}\ x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ t{\isachardot}\ r\ {\isacharequal}\ reach\ t\ w\ x{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}r{\isachardot}\ r\ {\isacharequal}\ int\ {\isacharparenleft}foldr\ {\isacharparenleft}{\isasymlambda}x{\isachardot}{\isacharparenleft}plus\ {\isacharparenleft}of{\isacharunderscore}bool\ x{\isacharparenright}{\isacharparenright}{\isacharparenright}\ w\ {\isadigit{0}}{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ reserve{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}r{\isachardot}\ {\isasymexists}\ x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ t{\isachardot}\ r\ {\isacharequal}\ reach\ t\ w\ x{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}int\ {\isacharparenleft}length\ w{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ ListOfAdverse{\isacharunderscore}count{\isacharunderscore}eq{\isacharunderscore}length\ assms{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}lambda\ t\ w\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ lambda{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \isanewline
\isacommand{definition}\isamarkupfalse%
\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharparenleft}nat\ list{\isacharcomma}\ nat\ list{\isacharparenright}\ prod{\isacharparenright}\ set{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ {\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t\isanewline
\ \ \ {\isacharequal}\ {\isacharbraceleft}{\isacharparenleft}x{\isacharcomma}y{\isacharparenright}{\isachardot}\ x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ t\ \isanewline
\ \ \ \ \ \ {\isasymand}\ y\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ t\isanewline
\ \ \ \ \ \ {\isasymand}\ edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ x\ y{\isacharbraceright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isanewline
\isacommand{definition}\isamarkupfalse%
\ margin\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nattree\ {\isasymRightarrow}\ \ bool\ list\ {\isasymRightarrow}\ int{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}margin\ t\ w\ {\isacharequal}\ Max\ {\isacharbraceleft}r{\isachardot}\ {\isacharparenleft}{\isasymexists}\ {\isacharparenleft}a{\isacharcomma}b{\isacharparenright}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t{\isachardot}\ r\ {\isacharequal}\ min\ {\isacharparenleft}reach\ t\ w\ a{\isacharparenright}\ {\isacharparenleft}reach\ t\ w\ b{\isacharparenright}{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ margin{\isacharunderscore}no{\isacharunderscore}honest\ {\isacharcolon}\ \isakeyword{assumes}\ {\isachardoublequoteopen}ListOfAdverse\ w{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}t{\isachardot}\ isFork\ w\ t\ {\isasymand}\ margin\ t\ w\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \isacommand{obtain}\isamarkupfalse%
\ l\ \isakeyword{where}\ {\isachardoublequoteopen}ListOfEmpty\ l{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ ListOfEmpty{\isachardot}Nil\ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ t\ \isakeyword{where}\ a{\isacharcolon}{\isachardoublequoteopen}Leaf\ t\ {\isasymand}\ t\ {\isacharequal}\ Node\ {\isadigit{0}}\ l\ {\isasymand}\ isFork\ w\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Leaf{\isachardot}intros\ Leaf{\isacharunderscore}inp{\isacharunderscore}ListOfAdverse{\isacharunderscore}trivial{\isacharunderscore}fork\ {\isacartoucheopen}ListOfEmpty\ l{\isacartoucheclose}\ assms\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\isachardoublequoteopen}gap\ t\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacartoucheopen}Leaf\ t\ {\isasymand}\ t\ {\isacharequal}\ Node\ {\isadigit{0}}\ l\ {\isasymand}\ isFork\ w\ t{\isacartoucheclose}\ gap{\isacharunderscore}def\ height{\isacharunderscore}Leaf\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ minus{\isacharunderscore}nat{\isachardot}diff{\isacharunderscore}{\isadigit{0}}{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}reserve\ w\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ reachge{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}reach\ t\ w\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}gap\ t\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isacartoucheclose}\ reach{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ tine{\isachardot}\ getLabelFromTine\ t\ tine\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Leaf{\isacharunderscore}imp{\isacharunderscore}nil{\isacharunderscore}label{\isacharunderscore}tine\ a\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ tine{\isachardot}\ length\ {\isacharparenleft}getLabelFromTine\ t\ tine{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ set{\isacharunderscore}nil{\isacharcolon}{\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}tines\ t\ {\isacharequal}\ {\isacharbraceleft}{\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ c{\isacharcolon}{\isachardoublequoteopen}{\isasymexists}\ x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ t{\isachardot}\ reach\ t\ w\ x\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ reachge{\isadigit{0}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ d{\isacharcolon}\ {\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t\ \ \isanewline
\ {\isacharequal}\ {\isacharbraceleft}{\isacharparenleft}x{\isacharcomma}y{\isacharparenright}{\isachardot}\ x\ {\isasymin}\ {\isacharbraceleft}{\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}\isanewline
\ \ \ \ \ \ {\isasymand}\ y\ {\isasymin}\ {\isacharbraceleft}{\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}\isanewline
\ \ \ \ \ \ {\isasymand}\ edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ x\ y{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ set{\isacharunderscore}nil\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ {\isacharparenleft}a{\isacharcomma}b{\isacharparenright}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t{\isachardot}\ \isanewline
\ a\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymand}\ b{\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharbrackleft}{\isacharbrackright}{\isacharcomma}{\isacharbrackleft}{\isacharbrackright}{\isacharparenright}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ case{\isacharunderscore}prodI\ d{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t\ {\isacharequal}\ {\isacharbraceleft}{\isacharparenleft}{\isacharbrackleft}{\isacharbrackright}{\isacharcomma}{\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}{\isasymforall}{\isacharparenleft}a{\isacharcomma}\ b{\isacharparenright}{\isasymin}set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t{\isachardot}\ a\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymand}\ b\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}\ {\isacharparenleft}a{\isacharcomma}b{\isacharparenright}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t{\isachardot}\ \isanewline
min\ {\isacharparenleft}reach\ t\ w\ a{\isacharparenright}\ {\isacharparenleft}reach\ t\ w\ b{\isacharparenright}\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ reachge{\isadigit{0}}{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}\ {\isacharparenleft}a{\isacharcomma}b{\isacharparenright}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t{\isachardot}\ \isanewline
min\ {\isacharparenleft}reach\ t\ w\ a{\isacharparenright}\ {\isacharparenleft}reach\ t\ w\ b{\isacharparenright}\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t\ {\isacharequal}\ {\isacharbraceleft}{\isacharparenleft}{\isacharbrackleft}{\isacharbrackright}{\isacharcomma}\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isacharbraceright}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}r{\isachardot}\ {\isasymexists}\ {\isacharparenleft}a{\isacharcomma}b{\isacharparenright}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t{\isachardot}\ r\ {\isacharequal}\ min\ {\isacharparenleft}reach\ t\ w\ a{\isacharparenright}\ {\isacharparenleft}reach\ t\ w\ b{\isacharparenright}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}r{\isachardot}\ r\ {\isacharequal}\ reach\ t\ w\ {\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t\ {\isacharequal}\ {\isacharbraceleft}{\isacharparenleft}{\isacharbrackleft}{\isacharbrackright}{\isacharcomma}\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isacharbraceright}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}r{\isachardot}\ {\isasymexists}\ {\isacharparenleft}a{\isacharcomma}b{\isacharparenright}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t{\isachardot}\ r\ {\isacharequal}\ min\ {\isacharparenleft}reach\ t\ w\ a{\isacharparenright}\ {\isacharparenleft}reach\ t\ w\ b{\isacharparenright}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}r{\isachardot}\ r\ {\isacharequal}\ int\ {\isacharparenleft}reserve\ w\ {\isacharparenleft}getLabelFromTine\ t\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ int\ {\isacharparenleft}gap\ t\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ reach{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}r{\isachardot}\ {\isasymexists}\ {\isacharparenleft}a{\isacharcomma}b{\isacharparenright}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t{\isachardot}\ r\ {\isacharequal}\ min\ {\isacharparenleft}reach\ t\ w\ a{\isacharparenright}\ {\isacharparenleft}reach\ t\ w\ b{\isacharparenright}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}r{\isachardot}\ r\ {\isacharequal}\ int\ {\isacharparenleft}reserve\ w\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}\ {\isacharminus}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ a\ b\ getLabelFromTine{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ of{\isacharunderscore}nat{\isacharunderscore}{\isadigit{0}}{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}r{\isachardot}\ {\isasymexists}\ {\isacharparenleft}a{\isacharcomma}b{\isacharparenright}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t{\isachardot}\ r\ {\isacharequal}\ min\ {\isacharparenleft}reach\ t\ w\ a{\isacharparenright}\ {\isacharparenleft}reach\ t\ w\ b{\isacharparenright}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}r{\isachardot}\ r\ {\isacharequal}\ int\ {\isacharparenleft}foldr\ {\isacharparenleft}{\isasymlambda}x{\isachardot}{\isacharparenleft}plus\ {\isacharparenleft}of{\isacharunderscore}bool\ x{\isacharparenright}{\isacharparenright}{\isacharparenright}\ w\ {\isadigit{0}}{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ reserve{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}r{\isachardot}\ {\isasymexists}\ {\isacharparenleft}a{\isacharcomma}b{\isacharparenright}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t{\isachardot}\ r\ {\isacharequal}\ min\ {\isacharparenleft}reach\ t\ w\ a{\isacharparenright}\ {\isacharparenleft}reach\ t\ w\ b{\isacharparenright}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}int\ {\isacharparenleft}length\ w{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ ListOfAdverse{\isacharunderscore}count{\isacharunderscore}eq{\isacharunderscore}length\ assms{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}margin\ t\ w\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ margin{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
This function is to construct, from an increasing tree, a tree not containing greater-labelled 
nodes than a certain number.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ remove{\isacharunderscore}greater\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ nattree\ {\isasymRightarrow}\ nattree{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}remove{\isacharunderscore}greater\ {\isacharunderscore}\ Empty\ {\isacharequal}\ Empty{\isachardoublequoteclose}\ \isanewline
\ \ {\isacharbar}\ {\isachardoublequoteopen}remove{\isacharunderscore}greater\ m\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}if\ n\ {\isacharless}\ m\ then\ Node\ n\ {\isacharparenleft}map\ {\isacharparenleft}remove{\isacharunderscore}greater\ m{\isacharparenright}\ l{\isacharparenright}\ else\ Empty{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ max{\isacharunderscore}honest{\isacharunderscore}node\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}max{\isacharunderscore}honest{\isacharunderscore}node\ w\ {\isacharequal}\ Max\ {\isacharbraceleft}r{\isachardot}\ r\ {\isasymin}\ H\ w{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \isanewline
\isacommand{fun}\isamarkupfalse%
\ count{\isacharunderscore}node{\isacharunderscore}by{\isacharunderscore}set\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ set\ {\isasymRightarrow}\ nattree\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}count{\isacharunderscore}node{\isacharunderscore}by{\isacharunderscore}set\ {\isacharunderscore}\ Empty\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}count{\isacharunderscore}node{\isacharunderscore}by{\isacharunderscore}set\ s\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}of{\isacharunderscore}bool\ {\isacharparenleft}n\ {\isasymin}\ s{\isacharparenright}{\isacharparenright}\ {\isacharplus}\ \ ListSum\ {\isacharparenleft}map\ {\isacharparenleft}count{\isacharunderscore}node{\isacharunderscore}by{\isacharunderscore}set\ s{\isacharparenright}\ l{\isacharparenright}{\isachardoublequoteclose}\ \ \isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ count{\isacharunderscore}honest{\isacharunderscore}node\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ nattree\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}count{\isacharunderscore}honest{\isacharunderscore}node\ w\ t\ {\isacharequal}\ count{\isacharunderscore}node{\isacharunderscore}by{\isacharunderscore}set\ {\isacharparenleft}H\ w{\isacharparenright}\ t{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ map{\isacharunderscore}ListOfEmpty\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}ListOfEmpty\ {\isacharparenleft}map\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ Empty{\isacharparenright}\ l{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}induction\ l{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ ListOfEmpty{\isachardot}Nil{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ ListOfEmpty{\isachardot}Cons{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ toClosedFork\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ nattree\ {\isasymRightarrow}\ nattree{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}toClosedFork\ {\isacharunderscore}\ Empty\ {\isacharequal}\ Empty{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}toClosedFork\ w\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\isanewline
{\isacharparenleft}if\ \ count{\isacharunderscore}honest{\isacharunderscore}node\ w\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isacharequal}\ of{\isacharunderscore}bool\ {\isacharparenleft}isHonest\ w\ n{\isacharparenright}\isanewline
\ \ then\ \isanewline
\ \ \ \ {\isacharparenleft}if\ isHonest\ w\ n\ then\ Node\ n\ {\isacharparenleft}map\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ Empty{\isacharparenright}\ l{\isacharparenright}\ else\ Empty{\isacharparenright}\isanewline
\ \ else\ Node\ n\ {\isacharparenleft}map\ {\isacharparenleft}toClosedFork\ w{\isacharparenright}\ l{\isacharparenright}\isanewline
{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ isFork{\isacharunderscore}toClosedFork{\isacharunderscore}isFork\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}isFork\ w\ F\ {\isasymlongrightarrow}\ isFork\ w\ {\isacharparenleft}toClosedFork\ w\ F{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{sorry}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ closedFork{\isacharunderscore}eq{\isacharunderscore}toClosedFork\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}isFork\ w\ F\ {\isasymlongrightarrow}\ F\ {\isacharequal}\ {\isacharparenleft}toClosedFork\ w\ F{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{sorry}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ toClosedFork{\isacharunderscore}prefixFork\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}isFork\ w\ F\ {\isasymlongrightarrow}\ isPrefix{\isacharunderscore}fork\ w\ w\ F\ {\isacharparenleft}toClosedFork\ w\ F{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{sorry}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ closedFork{\isacharunderscore}deepest{\isacharunderscore}honest{\isacharunderscore}node{\isacharunderscore}eq{\isacharunderscore}height\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}isFork\ w\ F\ {\isasymand}\ closedFork\ F\ w\ {\isasymlongrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ \ \ depth\ {\isacharparenleft}ClosedFork\ w\ F{\isacharparenright}\ {\isacharparenleft}max{\isacharunderscore}honest{\isacharunderscore}node\ w{\isacharparenright}\ {\isacharequal}\ Some\ {\isacharparenleft}height\ F{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{sorry}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ obtain{\isacharunderscore}two{\isacharunderscore}non{\isacharunderscore}negative{\isacharunderscore}reach{\isacharunderscore}tines{\isacharunderscore}toClosedFork\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}isFork\ w\ F\ {\isasymand}\ flatFork\ w\ F{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}t{\isadigit{1}}\ {\isasymin}\ set\ {\isacharparenleft}tinelist\ F{\isacharparenright}\ {\isasymand}\ t{\isadigit{2}}\ {\isasymin}\ set\ {\isacharparenleft}tinelist\ F{\isacharparenright}\ \isanewline
{\isasymand}\ length\ t{\isadigit{1}}\ {\isacharequal}\ length\ t{\isadigit{2}}\ {\isasymand}\ length\ t{\isadigit{1}}\ {\isacharequal}\ height\ F\ \isanewline
{\isasymlongrightarrow}\ \isanewline
{\isacharparenleft}{\isasymexists}\ t{\isadigit{1}}{\isacharprime}\ {\isasymin}\ set\ {\isacharparenleft}tinelist\ {\isacharparenleft}toClosedFork\ w\ F{\isacharparenright}{\isacharparenright}{\isachardot}\ \isanewline
{\isasymexists}\ t{\isadigit{2}}{\isacharprime}\ {\isasymin}\ set\ {\isacharparenleft}tinelist\ {\isacharparenleft}toClosedFork\ w\ F{\isacharparenright}{\isacharparenright}{\isachardot}\ \isanewline
isPrefix{\isacharunderscore}tine\ {\isacharparenleft}toClosedFork\ w\ F{\isacharparenright}\ F\ t{\isadigit{1}}{\isacharprime}\ t{\isadigit{1}}\ \isanewline
{\isasymand}\ isPrefix{\isacharunderscore}tine\ {\isacharparenleft}toClosedFork\ w\ F{\isacharparenright}\ F\ t{\isadigit{2}}{\isacharprime}\ t{\isadigit{2}}\isanewline
{\isasymand}\ edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ t{\isadigit{1}}{\isacharprime}\ t{\isadigit{2}}{\isacharprime}\ \isanewline
{\isasymand}\ reach\ {\isacharparenleft}toClosedFork\ w\ F{\isacharparenright}\ w\ t{\isadigit{1}}{\isacharprime}\ {\isasymge}\ {\isadigit{0}}\ \isanewline
{\isasymand}\ reach\ {\isacharparenleft}toClosedFork\ w\ F{\isacharparenright}\ w\ t{\isadigit{2}}{\isacharprime}\ {\isasymge}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\ \ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{sorry}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ if{\isacharunderscore}{\isadigit{4}}{\isacharunderscore}{\isadigit{1}}{\isadigit{7}}\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ \isakeyword{assumes}\ {\isachardoublequoteopen}isForkable\ w{\isachardoublequoteclose}\ \isakeyword{shows}\ \ {\isachardoublequoteopen}{\isacharparenleft}{\isasymexists}\ F{\isachardot}{\isacharparenleft}isFork\ w\ F\ {\isasymand}\ margin\ F\ w\ {\isasymge}\ {\isadigit{0}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}ListOfAdverse\ w{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ margin{\isacharunderscore}no{\isacharunderscore}honest\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{sorry}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ only{\isacharunderscore}if{\isacharunderscore}{\isadigit{4}}{\isacharunderscore}{\isadigit{1}}{\isadigit{7}}\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ \isakeyword{assumes}\ \ {\isachardoublequoteopen}{\isacharparenleft}{\isasymexists}\ F{\isachardot}{\isacharparenleft}isFork\ w\ F\ {\isasymand}\ margin\ F\ w\ {\isasymge}\ {\isadigit{0}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}\ isForkable\ w{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}ListOfAdverse\ w{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Leaf{\isachardot}intros\ ListOfEmpty{\isachardot}Nil\ flatFork{\isacharunderscore}Trivial\ forkable{\isacharunderscore}eq{\isacharunderscore}exist{\isacharunderscore}flatfork\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{sorry}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{proposition}\isamarkupfalse%
\ proposition{\isacharunderscore}{\isadigit{4}}{\isacharunderscore}{\isadigit{1}}{\isadigit{7}}\ {\isacharcolon}\ {\isachardoublequoteopen}isForkable\ w\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\isasymexists}\ F{\isachardot}{\isacharparenleft}isFork\ w\ F\ {\isasymand}\ margin\ F\ w\ {\isasymge}\ {\isadigit{0}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ if{\isacharunderscore}{\isadigit{4}}{\isacharunderscore}{\isadigit{1}}{\isadigit{7}}\ only{\isacharunderscore}if{\isacharunderscore}{\isadigit{4}}{\isacharunderscore}{\isadigit{1}}{\isadigit{7}}\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\ \isanewline
\isacommand{definition}\isamarkupfalse%
\ lambda{\isacharunderscore}of{\isacharunderscore}string\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ int{\isachardoublequoteclose}\ \isakeyword{where}\ \ \ \isanewline
\ \ {\isachardoublequoteopen}lambda{\isacharunderscore}of{\isacharunderscore}string\ w\ {\isacharequal}\ Max\ {\isacharbraceleft}t{\isachardot}\ {\isacharparenleft}{\isasymexists}F{\isachardot}{\isacharparenleft}isFork\ w\ F\ {\isasymand}\ closedFork\ F\ w\ {\isasymand}\ t\ {\isacharequal}\ lambda\ F\ w{\isacharparenright}{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ max{\isacharunderscore}node{\isacharunderscore}lowerbound\ {\isacharcolon}\ {\isachardoublequoteopen}max{\isacharunderscore}node\ {\isacharparenleft}Node\ n\ l{\isacharparenright}\ {\isasymge}\ n{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\ \isanewline
\ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ max{\isacharunderscore}node{\isacharunderscore}lowerbound{\isacharunderscore}branch\ {\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymexists}\ x\ {\isasymin}\ set\ l{\isachardot}\ x\ {\isacharequal}\ Node\ n\ ll{\isacharparenright}\ {\isasymlongrightarrow}\ max{\isacharunderscore}node\ {\isacharparenleft}Node\ m\ l{\isacharparenright}\ {\isasymge}\ n\ {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Listmax{\isacharunderscore}ge\ dual{\isacharunderscore}order{\isachardot}trans\ image{\isacharunderscore}eqI\ list{\isachardot}set{\isacharunderscore}intros{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ max{\isacharunderscore}node{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ max{\isacharunderscore}node{\isacharunderscore}lowerbound\ set{\isacharunderscore}map{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ isFork{\isacharunderscore}Nil\ {\isacharcolon}\ \isakeyword{assumes}\ {\isachardoublequoteopen}isFork\ {\isacharbrackleft}{\isacharbrackright}\ F{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}Leaf\ F\ {\isasymand}\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}\ F{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ inc\ {\isacharcolon}\ {\isachardoublequoteopen}increasing{\isacharunderscore}tree\ F{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ isFork{\isacharunderscore}increasing{\isacharunderscore}tree\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ root{\isadigit{0}}{\isacharcolon}\ \ {\isachardoublequoteopen}root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}\ F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ isFork{\isacharunderscore}root{\isacharunderscore}{\isadigit{0}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ l\ \isakeyword{where}\ Fnode{\isacharcolon}\ \ {\isachardoublequoteopen}F\ {\isacharequal}\ Node\ {\isadigit{0}}\ l{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}{\isachardot}cases\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ ListOfEmpty\ l\ {\isasymlongrightarrow}\ {\isacharparenleft}{\isasymexists}\ x\ {\isasymin}\ set\ l{\isachardot}\ x\ {\isasymnoteq}\ Empty{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ ListOfEmpty\ l\ {\isasymlongrightarrow}\ {\isacharparenleft}{\isasymexists}\ n{\isachardot}\ {\isacharparenleft}{\isasymexists}ll{\isachardot}\ Node\ n\ ll\ {\isasymin}\ set\ l{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacartoucheopen}F\ {\isacharequal}\ Node\ {\isadigit{0}}\ l{\isacartoucheclose}\ assms\ increasing{\isacharunderscore}tree{\isacharunderscore}ind\ isFork{\isacharunderscore}increasing{\isacharunderscore}tree\ lt{\isacharunderscore}nat{\isacharunderscore}tree{\isachardot}elims{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ ListOfEmpty\ l\ {\isasymlongrightarrow}\ {\isacharparenleft}{\isasymexists}\ n{\isachardot}\ n\ {\isachargreater}\ {\isadigit{0}}\ {\isasymand}\ {\isacharparenleft}{\isasymexists}ll{\isachardot}\ Node\ n\ ll\ {\isasymin}\ set\ l{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Fnode\ inc\ increasing{\isacharunderscore}tree{\isacharunderscore}ind\ lt{\isacharunderscore}nat{\isacharunderscore}tree{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ ListOfEmpty\ l\ {\isasymlongrightarrow}\ {\isacharparenleft}max{\isacharunderscore}node\ F\ {\isachargreater}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Fnode\ gr{\isadigit{0}}I\ max{\isacharunderscore}node{\isacharunderscore}lowerbound{\isacharunderscore}branch\ not{\isacharunderscore}le{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Fnode\ Leaf{\isachardot}intros\ assms\ isFork{\isacharunderscore}max{\isacharunderscore}not{\isacharunderscore}exceed\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ not{\isacharunderscore}le\ root{\isadigit{0}}{\isacharparenright}\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ label{\isacharunderscore}from{\isacharunderscore}Leaf{\isacharunderscore}eq{\isacharunderscore}nil\ {\isacharcolon}\ \isakeyword{assumes}\ {\isachardoublequoteopen}Leaf\ t{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}getLabelFromTine\ t\ x\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Leaf{\isachardot}cases\ Leaf{\isacharunderscore}imp{\isacharunderscore}nil{\isacharunderscore}label{\isacharunderscore}tine\ assms{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ reserve{\isacharunderscore}nil{\isacharunderscore}nil\ {\isacharcolon}\ {\isachardoublequoteopen}reserve\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ reserve{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ lambda{\isacharunderscore}of{\isacharunderscore}nil{\isacharunderscore}aux\ {\isacharcolon}\ \isakeyword{assumes}\ {\isachardoublequoteopen}isFork\ {\isacharbrackleft}{\isacharbrackright}\ F\ {\isasymand}\ closedFork\ F\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}lambda\ F\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \ \ \isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}Leaf\ F\ {\isasymand}\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}\ F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ isFork{\isacharunderscore}Nil\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ reach\ F\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ \ int\ {\isacharparenleft}reserve\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharparenleft}getLabelFromTine\ F\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ int\ {\isacharparenleft}gap\ F\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ reach{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}reach\ F\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ int\ {\isacharparenleft}reserve\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}\ {\isacharminus}\ int\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{1}}\ gap{\isacharunderscore}def\ height{\isacharunderscore}Leaf\ label{\isacharunderscore}from{\isacharunderscore}Leaf{\isacharunderscore}eq{\isacharunderscore}nil\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}reach\ F\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ reserve{\isacharunderscore}nil{\isacharunderscore}nil\ \ \isacommand{by}\isamarkupfalse%
\ presburger\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}lambda\ F\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}\ getLabelFromTine\ F\ x\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{1}}\ label{\isacharunderscore}from{\isacharunderscore}Leaf{\isacharunderscore}eq{\isacharunderscore}nil\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}tines\ F\ {\isacharequal}\ {\isacharbraceleft}tine{\isachardot}\ length\ tine\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ lifting{\isacharparenright}\ Collect{\isacharunderscore}cong\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ set{\isacharunderscore}of{\isacharunderscore}tines{\isachardot}elims{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ set{\isacharunderscore}nil{\isacharcolon}{\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}tines\ F\ {\isacharequal}\ {\isacharbraceleft}{\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ Collect{\isacharunderscore}cong\ length{\isacharunderscore}greater{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}conv\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ singleton{\isacharunderscore}conv{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymforall}\ x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ F{\isachardot}\ reach\ F\ {\isacharbrackleft}{\isacharbrackright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacartoucheopen}reach\ F\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isacartoucheclose}\ singletonD{\isacharparenright}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymexists}\ x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ F{\isachardot}\ reach\ F\ {\isacharbrackleft}{\isacharbrackright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ set{\isacharunderscore}nil\ {\isacartoucheopen}reach\ F\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Max\ {\isacharbraceleft}r{\isachardot}\ {\isasymexists}\ x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ F{\isachardot}\ r\ {\isacharequal}\ reach\ F\ {\isacharbrackleft}{\isacharbrackright}\ x{\isacharbraceright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}reach\ F\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isacartoucheclose}\ set{\isacharunderscore}nil\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ lambda{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ lambda{\isacharunderscore}of{\isacharunderscore}nil\ {\isacharcolon}\ {\isachardoublequoteopen}lambda{\isacharunderscore}of{\isacharunderscore}string\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \ \isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ F\ \isakeyword{where}\ F{\isacharcolon}{\isachardoublequoteopen}isFork\ {\isacharbrackleft}{\isacharbrackright}\ F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ ListOfAdverse{\isachardot}Nil\ margin{\isacharunderscore}no{\isacharunderscore}honest\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}Leaf\ F\ {\isasymand}\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}\ F{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ isFork{\isacharunderscore}Nil{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}closedFork\ F\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{1}}\ ListOfAdverse{\isachardot}Nil\ closedFork{\isacharunderscore}ListOfAdverse\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}{\isachardot}cases\ \isacommand{by}\isamarkupfalse%
\ blast\ \ \ \ \ \ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ ss\ \isakeyword{where}\ ss{\isacharcolon}{\isachardoublequoteopen}ss\ {\isacharequal}\ {\isacharbraceleft}t{\isachardot}\ {\isasymexists}f{\isachardot}\ isFork\ {\isacharbrackleft}{\isacharbrackright}\ f\ {\isasymand}\ closedFork\ f\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymand}\ t\ {\isacharequal}\ lambda\ f\ {\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}in{\isacharcolon}\ {\isachardoublequoteopen}ss\ {\isacharequal}\ {\isacharbraceleft}{\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ Collect{\isacharunderscore}cong\ F\ {\isacartoucheopen}closedFork\ F\ {\isacharbrackleft}{\isacharbrackright}{\isacartoucheclose}\ lambda{\isacharunderscore}of{\isacharunderscore}nil{\isacharunderscore}aux\ singleton{\isacharunderscore}conv{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Max\ ss\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Max\ {\isacharbraceleft}i{\isachardot}\ {\isasymexists}n{\isachardot}\ isFork\ {\isacharbrackleft}{\isacharbrackright}\ n\ {\isasymand}\ closedFork\ n\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymand}\ i\ {\isacharequal}\ lambda\ n\ {\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}Max\ ss\ {\isacharequal}\ {\isadigit{0}}{\isacartoucheclose}\ ss\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ lambda{\isacharunderscore}of{\isacharunderscore}string{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{definition}\isamarkupfalse%
\ margin{\isacharunderscore}of{\isacharunderscore}string\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ int{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}margin{\isacharunderscore}of{\isacharunderscore}string\ w\ {\isacharequal}\ Max\ {\isacharbraceleft}t{\isachardot}\ {\isacharparenleft}{\isasymexists}F{\isachardot}{\isacharparenleft}isFork\ w\ F\ {\isasymand}\ closedFork\ F\ w\ {\isasymand}\ t\ {\isacharequal}\ margin\ F\ w{\isacharparenright}{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ margin{\isacharunderscore}of{\isacharunderscore}nil{\isacharunderscore}aux\ {\isacharcolon}\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}isFork\ {\isacharbrackleft}{\isacharbrackright}\ F\ {\isasymand}\ closedFork\ F\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}margin\ F\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \ \ \isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}Leaf\ F\ {\isasymand}\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}\ F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ isFork{\isacharunderscore}Nil\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ reach\ F\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ \ int\ {\isacharparenleft}reserve\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharparenleft}getLabelFromTine\ F\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ int\ {\isacharparenleft}gap\ F\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ reach{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}reach\ F\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ int\ {\isacharparenleft}reserve\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}\ {\isacharminus}\ int\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{1}}\ gap{\isacharunderscore}def\ height{\isacharunderscore}Leaf\ label{\isacharunderscore}from{\isacharunderscore}Leaf{\isacharunderscore}eq{\isacharunderscore}nil\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ reach{\isadigit{0}}{\isacharcolon}{\isachardoublequoteopen}reach\ F\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ reserve{\isacharunderscore}nil{\isacharunderscore}nil\ \ \isacommand{by}\isamarkupfalse%
\ presburger\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}\ getLabelFromTine\ F\ x\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{1}}\ label{\isacharunderscore}from{\isacharunderscore}Leaf{\isacharunderscore}eq{\isacharunderscore}nil\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}tines\ F\ {\isacharequal}\ {\isacharbraceleft}tine{\isachardot}\ length\ tine\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ lifting{\isacharparenright}\ Collect{\isacharunderscore}cong\ list{\isachardot}size{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ set{\isacharunderscore}of{\isacharunderscore}tines{\isachardot}elims{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}tines\ F\ {\isacharequal}\ {\isacharbraceleft}{\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ F\ {\isachardot}\ x\ {\isacharequal}\ \ {\isacharbrackleft}{\isacharbrackright}\ {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ F\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ {\isacharbraceleft}{\isacharparenleft}x{\isacharcomma}y{\isacharparenright}{\isachardot}\ x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ F\ {\isasymand}\ y\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ F{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}set{\isacharunderscore}of{\isacharunderscore}tines\ F\ {\isacharequal}\ {\isacharbraceleft}{\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}{\isacartoucheclose}\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ all{\isacharcolon}{\isachardoublequoteopen}{\isasymforall}\ {\isacharparenleft}a{\isacharcomma}b{\isacharparenright}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ F{\isachardot}\ {\isacharparenleft}a{\isacharcomma}b{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isacharbrackleft}{\isacharbrackright}{\isacharcomma}{\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}{\isasymforall}x{\isasymin}set{\isacharunderscore}of{\isacharunderscore}tines\ F{\isachardot}\ x\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ exist{\isacharcolon}\ {\isachardoublequoteopen}{\isasymexists}\ {\isacharparenleft}a{\isacharcomma}b{\isacharparenright}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ F{\isachardot}\ {\isacharparenleft}a{\isacharcomma}b{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isacharbrackleft}{\isacharbrackright}{\isacharcomma}{\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ F\ {\isacharequal}\ {\isacharbraceleft}{\isacharparenleft}x{\isacharcomma}\ y{\isacharparenright}{\isachardot}\ x\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ F\ {\isasymand}\ y\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}tines\ F{\isacharbraceright}{\isacartoucheclose}\ {\isacartoucheopen}set{\isacharunderscore}of{\isacharunderscore}tines\ F\ {\isacharequal}\ {\isacharbraceleft}{\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ set{\isacharunderscore}nil{\isacharunderscore}pair{\isacharcolon}{\isachardoublequoteopen}set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ F{\isacharequal}{\isacharbraceleft}{\isacharparenleft}{\isacharbrackleft}{\isacharbrackright}{\isacharcomma}{\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ all\ \isacommand{by}\isamarkupfalse%
\ blast\ \ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Max\ {\isacharbraceleft}r{\isachardot}\ {\isacharparenleft}{\isasymexists}\ {\isacharparenleft}a{\isacharcomma}b{\isacharparenright}\ {\isasymin}\ set{\isacharunderscore}of{\isacharunderscore}edge{\isacharunderscore}disjoint{\isacharunderscore}tines\ F{\isachardot}\ r\ {\isacharequal}\ min\ {\isacharparenleft}reach\ F\ {\isacharbrackleft}{\isacharbrackright}\ a{\isacharparenright}\ {\isacharparenleft}reach\ F\ {\isacharbrackleft}{\isacharbrackright}\ b{\isacharparenright}{\isacharparenright}{\isacharbraceright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ reach{\isadigit{0}}\ set{\isacharunderscore}nil{\isacharunderscore}pair\ \isacommand{by}\isamarkupfalse%
\ auto\ \ \isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ margin{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ margin{\isacharunderscore}of{\isacharunderscore}nil{\isacharcolon}\ {\isachardoublequoteopen}margin{\isacharunderscore}of{\isacharunderscore}string\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ F\ \isakeyword{where}\ {\isachardoublequoteopen}isFork\ {\isacharbrackleft}{\isacharbrackright}\ F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ ListOfAdverse{\isachardot}Nil\ margin{\isacharunderscore}no{\isacharunderscore}honest\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}Leaf\ F\ {\isasymand}\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}\ F{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ isFork{\isacharunderscore}Nil{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}closedFork\ F\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{1}}\ ListOfAdverse{\isachardot}Nil\ closedFork{\isacharunderscore}ListOfAdverse\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}{\isachardot}cases\ \isacommand{by}\isamarkupfalse%
\ blast\ \ \ \isanewline
\ \ \ \isacommand{obtain}\isamarkupfalse%
\ ss\ \isakeyword{where}\ ss{\isacharcolon}{\isachardoublequoteopen}ss\ {\isacharequal}\ {\isacharbraceleft}t{\isachardot}\ {\isasymexists}f{\isachardot}\ isFork\ {\isacharbrackleft}{\isacharbrackright}\ f\ {\isasymand}\ closedFork\ f\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymand}\ t\ {\isacharequal}\ margin\ f\ {\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}in{\isacharcolon}\ {\isachardoublequoteopen}ss\ {\isacharequal}\ {\isacharbraceleft}{\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}smt\ Collect{\isacharunderscore}cong\ ListOfAdverse{\isachardot}Nil\ closedFork{\isacharunderscore}ListOfAdverse\ isFork{\isacharunderscore}Nil\ margin{\isacharunderscore}no{\isacharunderscore}honest\ margin{\isacharunderscore}of{\isacharunderscore}nil{\isacharunderscore}aux\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}{\isachardot}cases\ singleton{\isacharunderscore}conv{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Max\ ss\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Max\ {\isacharbraceleft}i{\isachardot}\ {\isasymexists}n{\isachardot}\ isFork\ {\isacharbrackleft}{\isacharbrackright}\ n\ {\isasymand}\ closedFork\ n\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymand}\ i\ {\isacharequal}\ margin\ n\ {\isacharbrackleft}{\isacharbrackright}{\isacharbraceright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}Max\ ss\ {\isacharequal}\ {\isadigit{0}}{\isacartoucheclose}\ ss\ \isacommand{by}\isamarkupfalse%
\ blast\ \ \ \ \ \ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ margin{\isacharunderscore}of{\isacharunderscore}string{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ presburger\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \ \ \ \ \isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{definition}\isamarkupfalse%
\ m\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ {\isacharparenleft}int{\isacharcomma}\ int{\isacharparenright}\ prod{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}m\ w\ {\isacharequal}\ {\isacharparenleft}lambda{\isacharunderscore}of{\isacharunderscore}string\ w{\isacharcomma}\ margin{\isacharunderscore}of{\isacharunderscore}string\ w{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ lemma{\isacharunderscore}{\isadigit{4}}{\isacharunderscore}{\isadigit{1}}{\isadigit{8}}{\isacharunderscore}trivial{\isacharunderscore}case{\isacharunderscore}m\ {\isacharcolon}\ {\isachardoublequoteopen}m\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isacharparenleft}{\isadigit{0}}{\isacharcomma}{\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ lambda{\isacharunderscore}of{\isacharunderscore}nil\ m{\isacharunderscore}def\ margin{\isacharunderscore}of{\isacharunderscore}nil{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ lemma{\isacharunderscore}{\isadigit{4}}{\isacharunderscore}{\isadigit{1}}{\isadigit{8}}{\isacharunderscore}trivial{\isacharunderscore}case{\isacharunderscore}exist{\isacharunderscore}Fork\ {\isacharcolon}\ \isanewline
{\isachardoublequoteopen}{\isasymexists}\ F{\isachardot}\ {\isacharparenleft}isFork\ {\isacharbrackleft}{\isacharbrackright}\ F\ {\isasymand}\ closedFork\ F\ {\isacharbrackleft}{\isacharbrackright}\ \ {\isasymand}\ {\isacharparenleft}m\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isacharparenleft}lambda\ F\ {\isacharbrackleft}{\isacharbrackright}{\isacharcomma}\ margin\ F\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ ListOfAdverse{\isachardot}Nil\ closedFork{\isacharunderscore}ListOfAdverse\ isFork{\isacharunderscore}Nil\ lambda{\isacharunderscore}of{\isacharunderscore}nil{\isacharunderscore}aux\ lemma{\isacharunderscore}{\isadigit{4}}{\isacharunderscore}{\isadigit{1}}{\isadigit{8}}{\isacharunderscore}trivial{\isacharunderscore}case{\isacharunderscore}m\ margin{\isacharunderscore}no{\isacharunderscore}honest\ margin{\isacharunderscore}of{\isacharunderscore}nil{\isacharunderscore}aux\ root{\isacharunderscore}label{\isacharunderscore}{\isadigit{0}}{\isachardot}cases{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ lemma{\isacharunderscore}{\isadigit{4}}{\isacharunderscore}{\isadigit{1}}{\isadigit{8}}\ {\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}m\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isacharparenleft}{\isadigit{0}}{\isacharcomma}{\isadigit{0}}{\isacharparenright}{\isacharparenright}\ {\isasymand}\ \isanewline
\ \ {\isacharparenleft}{\isasymforall}\ w{\isachardot}\ {\isacharparenleft}{\isacharparenleft}length\ w\ {\isachargreater}\ {\isadigit{0}}{\isacharparenright}\ {\isasymlongrightarrow}\ {\isacharparenleft}\ \isanewline
\ \ \ \ {\isacharparenleft}m\ {\isacharparenleft}w\ {\isacharat}\ {\isacharbrackleft}True{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}lambda{\isacharunderscore}of{\isacharunderscore}string\ w\ {\isacharplus}\ {\isadigit{1}}{\isacharcomma}\ margin{\isacharunderscore}of{\isacharunderscore}string\ w\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ \isanewline
\ \ \ \ \ {\isasymand}\ \ \ {\isacharparenleft}{\isacharparenleft}lambda{\isacharunderscore}of{\isacharunderscore}string\ w\ {\isachargreater}\ margin{\isacharunderscore}of{\isacharunderscore}string\ w{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}margin{\isacharunderscore}of{\isacharunderscore}string\ w\ {\isacharequal}\ {\isadigit{0}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymlongrightarrow}\ {\isacharparenleft}m\ {\isacharparenleft}w\ {\isacharat}\ {\isacharbrackleft}False{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}lambda{\isacharunderscore}of{\isacharunderscore}string\ w\ {\isacharminus}\ {\isadigit{1}}{\isacharcomma}\ {\isadigit{0}}{\isacharparenright}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ {\isasymand}\ \ \ {\isacharparenleft}lambda{\isacharunderscore}of{\isacharunderscore}string\ w\ {\isacharequal}\ {\isadigit{0}}\ {\isasymlongrightarrow}\ {\isacharparenleft}m\ {\isacharparenleft}w\ {\isacharat}\ {\isacharbrackleft}False{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isadigit{0}}{\isacharcomma}\ margin{\isacharunderscore}of{\isacharunderscore}string\ w\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ {\isasymand}\ \ \ {\isacharparenleft}lambda{\isacharunderscore}of{\isacharunderscore}string\ w\ {\isachargreater}\ {\isadigit{0}}\ {\isasymand}\ margin{\isacharunderscore}of{\isacharunderscore}string\ w\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymlongrightarrow}\ {\isacharparenleft}m\ {\isacharparenleft}w\ {\isacharat}\ {\isacharbrackleft}False{\isacharbrackright}{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharequal}\ {\isacharparenleft}lambda{\isacharunderscore}of{\isacharunderscore}string\ w\ {\isacharminus}\ {\isadigit{1}}{\isacharcomma}\ margin{\isacharunderscore}of{\isacharunderscore}string\ w\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharparenright}\ \isanewline
{\isasymand}\ {\isacharparenleft}{\isasymexists}\ F{\isachardot}\ {\isacharparenleft}isFork\ w\ F\ {\isasymand}\ closedFork\ F\ w\ \ {\isasymand}\ {\isacharparenleft}m\ w\ {\isacharequal}\ {\isacharparenleft}lambda\ F\ w{\isacharcomma}\ margin\ F\ w{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{sorry}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\ \ \ \ \isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "root"
%%% End:
